<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>é•·ç”Ÿæ‘æœ¬éƒ·Engineers&#39;Blog</title>
  
  <subtitle>åƒè‘‰çœŒé•·ç”Ÿæ‘æœ¬éƒ·è‚²ã¡ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒæ›¸ã„ã¦ã„ã‚‹ãƒ–ãƒ­ã‚°</subtitle>
  <link href="https://kenzo0107.github.io/atom.xml" rel="self"/>
  
  <link href="https://kenzo0107.github.io/"/>
  <updated>2024-12-18T15:00:00.000Z</updated>
  <id>https://kenzo0107.github.io/</id>
  
  <author>
    <name>Kenzo Tanaka</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RDS ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ä¸€è¦§</title>
    <link href="https://kenzo0107.github.io/2024/12/18/2024-12-19-rds-replicate-to-glue-iceberg-table/"/>
    <id>https://kenzo0107.github.io/2024/12/18/2024-12-19-rds-replicate-to-glue-iceberg-table/</id>
    <published>2024-12-18T15:00:00.000Z</published>
    <updated>2024-12-18T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#rdsgluejobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB">RDSâ†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#rds-zero-etl-%E7%B5%B1%E5%90%88-redshift-%E3%81%B8%E3%83%AC%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%83%88">RDS Zero-ETL çµ±åˆ Redshift ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆ</a></li><li><a href="#rdsdmss3gluejobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB">RDSâ†’DMSâ†’S3â†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#rdsdebeziummsks3glue-jobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB">RDSâ†’debeziumâ†’MSKâ†’S3â†’Glue Jobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#rdsdata-firehoseiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB-preview-%E7%89%88">RDSâ†’Data Firehoseâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ« (preview ç‰ˆ)</a></li><li><a href="#rds-%E3%82%92%E5%85%B1%E6%9C%89%E3%81%97%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%B3">RDS ã‚’å…±æœ‰ã—ã‚¯ãƒ­ãƒ¼ãƒ³</a></li><li><a href="#%E7%B7%8F%E8%A9%95">ç·è©•</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>RDS ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ãŒå¤šæ•°ã‚ã£ãŸã®ã§ãã®ä¸€è¦§ã‚’ã¾ã¨ã‚ã¾ã™ã€‚</p><p>RDS ã‚’ãƒ¦ãƒ¼ã‚¶å½±éŸ¿ã‚’æ¥µåŠ›ä½ãã™ã¹ãã€åˆ†æç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã—ã¦ã€åˆ†æã™ã‚‹æ–¹æ³•ãŒå¤šã€…ã‚ã£ãŸã®ã§ç§è¦‹ã§ã™ãŒ Pros/Cons ã‚’ã¾ã¨ã‚ã¾ã™ã€‚</p><span id="more"></span><h2><span id="rdsgluejobiceberg-ãƒ†ãƒ¼ãƒ–ãƒ«">RDSâ†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</span></h2><pre class="mermaid">graph LRRDS--"SELECT * FROM table"-->GlueJob-->Icebergãƒ†ãƒ¼ãƒ–ãƒ«</pre><p>Glue Job ã‹ã‚‰ Glue Connection çµŒç”±ã§ RDS ã«æ¥ç¶šã—ã€ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã€æŠ½å‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã—ã¾ã™ã€‚</p><ul><li>Pros:<ul><li>ã‚³ã‚¹ãƒˆå®‰</li></ul></li><li>Cons:<ul><li>ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤ã«å¯¾å¿œã§ããªã„<ul><li>è«–ç†å‰Šé™¤ã§ã‚ã‚Œã°å¯¾å¿œã¯ã§ãã‚‹ãŒã€ç‰©ç†å‰Šé™¤ã•ã‚Œã‚‹ã¨æ¤œçŸ¥ã§ããªã„</li><li>å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ç›´ã™ã€ã‚‚ã—ãã¯ã€å‰Šé™¤ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®šã™ã‚‹æ§˜ã€RDS å´ã¨ Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã§çªãåˆã‚ã›ã‚‹æ–¹æ³•ã¯ã‚ã‚‹ãŒã€ãƒªã‚½ãƒ¼ã‚¹é€¼è¿«ã•ã›ã¦ã—ã¾ã†æã‚ŒãŒã‚ã‚‹</li></ul></li><li>ãƒ†ãƒ¼ãƒ–ãƒ«æ¯ã«ãƒ‡ãƒ¼ã‚¿å–å¾—æ™‚ã®è­˜åˆ¥å­ (PK ç›¸å½“) ã¨ãªã‚‹ã‚«ãƒ©ãƒ ã‚’æ±ºå®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹<ul><li>PK ãŒãªã„å ´åˆã€åˆ¥é€”æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚</li><li>ä¾‹ãˆã°æ›´æ–°ã•ã‚Œã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã€ updated_at ã‚’ã‚­ãƒ¼ã«ã—ã€å·®åˆ†æŠ½å‡ºã™ã‚‹ã‚ˆã†ãªå‡¦ç†ãŒå¿…è¦ã«ãªã‚‹</li></ul></li><li>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã‚’è¿½æ±‚ã™ã‚‹ã¨å®Ÿè¡Œã‚³ã‚¹ãƒˆãŒåµ©ã‚€</li></ul></li></ul><p>é‹ç”¨ã‚³ã‚¹ãƒˆãŒé«˜ãã€å¤§è¦æ¨¡ãª DB ç’°å¢ƒã«ã¯å‘ã‹ãªã„ã€‚</p><h2><span id="rds-zero-etl-çµ±åˆ-redshift-ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆ">RDS Zero-ETL çµ±åˆ Redshift ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆ</span></h2><pre class="mermaid">graph LRRDS--Zero-ETL-->Redshift</pre><p>å‚è€ƒ: <a href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/zero-etl.html">Amazon Redshift ã¨ã® Amazon RDS ã‚¼ãƒ­ ETL çµ±åˆã§ã®ä½œæ¥­</a></p><p>RDS ã® Zero-ETL çµ±åˆã«ã‚ˆã‚Šå®Œå…¨ãƒãƒãƒ¼ã‚¸ãƒ‰ã§ Redshift ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã—ã¾ã™ã€‚<br>ä»–ã®æ‰‹æ³•ã¨ç•°ãªã‚Šã€ Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã§ãªã Redshift ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ãªã‚Šã¾ã™ã€‚</p><ul><li>Pros:<ul><li>å®Œå…¨ãƒãƒãƒ¼ã‚¸ãƒ‰ãªã‚µãƒ¼ãƒ“ã‚¹ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸è¦</li><li>Redshift ã¯ dbt ã¨ã®ç›¸æ€§ãŒè‰¯ã„</li></ul></li><li>Cons:<ul><li>Redshift ã‚³ã‚¹ãƒˆé«˜<ul><li>Serverless ã§ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆé–“éš”ã‚’åºƒã’ã‚‹ã“ã¨ã§ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‹ã“ã¨ã¯ã§ããã†ã ãŒã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã¯æãªã‚ã‚Œã‚‹</li></ul></li><li>Aurora ä»¥å¤–ã¯ã‚µãƒãƒ¼ãƒˆå¤– (2024.12.19 æ™‚ç‚¹)</li></ul></li></ul><h2><span id="rdsdmss3gluejobiceberg-ãƒ†ãƒ¼ãƒ–ãƒ«">RDSâ†’DMSâ†’S3â†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</span></h2><pre class="mermaid">graph LRRDS--CDC-->DMS-->S3--GlueJob-->Icebergãƒ†ãƒ¼ãƒ–ãƒ«</pre><p>å‚è€ƒ: <a href="https://aws.amazon.com/jp/blogs/big-data/modernize-your-legacy-databases-with-aws-data-lakes-part-2-build-a-data-lake-using-aws-dms-data-on-apache-iceberg/">Modernize your legacy databases with AWS data lakes, Part 2: Build a data lake using AWS DMS data on Apache Iceberg</a></p><ul><li>Pros:<ul><li>Redshift ã‚ˆã‚Šã¯å®‰ãæ¸ˆã¿ãã†</li></ul></li><li>Cons:<ul><li>DMS é‹ç”¨ã‚³ã‚¹ãƒˆãŒé«˜ã„ï¼ˆAWS SA æ§˜ã‚ˆã‚Šé ‚ã„ãŸæ„è¦‹ï¼‰<ul><li>ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¯ã®ä»•æ§˜å·®ã«ã‚ˆã‚‹éšœå®³ç™ºç”Ÿ</li><li>æ¯”è¼ƒçš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ãŒå¤šã„</li><li>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—æ™‚ã«ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã‚’åœæ­¢ã—ã€å†åº¦ãƒ†ãƒ¼ãƒ–ãƒ«ä½œã‚Šç›´ã™å¿…è¦ãŒã‚ã‚‹ãªã©æ‰‹é–“ãŒå¤šã„</li></ul></li><li>Glue Job ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆæ›´æ–°ãƒ»è¿½åŠ ãƒ»å‰Šé™¤ï¼‰ãŒç…©é›‘åŒ–ã™ã‚‹</li><li>ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã« Glue Job ã§å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚‹</li></ul></li></ul><p>DMS æ¡ç”¨ä¼æ¥­ã¯ã‚ã‚‹</p><ul><li><a href="https://techlife.cookpad.com/entry/2024/10/16/101605">ã‚¯ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ - DMS ã‚’åˆ©ç”¨ã—ãŸç¶™ç¶šçš„ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ¤œçŸ¥</a></li></ul><h2><span id="rdsdebeziummsks3glue-jobiceberg-ãƒ†ãƒ¼ãƒ–ãƒ«">RDSâ†’debeziumâ†’MSKâ†’S3â†’Glue Jobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«</span></h2><pre class="mermaid">graph LRRDS--CDC-->debeziumdebezium-->MSKMSK--Parquet-->S3S3-->GlueJobGlueJob-->Icebergãƒ†ãƒ¼ãƒ–ãƒ«</pre><p>å‚è€ƒ: <a href="https://aws.amazon.com/jp/blogs/big-data/synchronize-data-lakes-with-cdc-based-upsert-using-open-table-format-aws-glue-and-amazon-msk/">Synchronize data lakes with CDC-based UPSERT using open table format, AWS Glue, and Amazon MSK</a></p><p>MSK ã§ CDC ãƒ‡ãƒ¼ã‚¿ã‚’ Parquet ã§ S3 ã«ä¿å­˜ã—ã€ Glue Job ã§ Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤‰æ›ã—ã¾ã™ã€‚</p><ul><li>Pros:<ul><li>RDS Zero-ETL ã‚µãƒãƒ¼ãƒˆå¤–ã® <code>MariaDB</code> ã«ã‚‚å¯¾å¿œã§ãã‚‹</li></ul></li><li>Cons:<ul><li>debezium, MSK ç­‰ã®å­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„ï¼ˆå€‹äººã®æ„Ÿæƒ³ï¼‰</li><li>Glue Job ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆæ›´æ–°ãƒ»è¿½åŠ ãƒ»å‰Šé™¤ï¼‰ãŒç…©é›‘åŒ–ã™ã‚‹</li><li>ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã« Glue Job ã§å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚‹</li></ul></li></ul><h2><span id="rdsdata-firehoseiceberg-ãƒ†ãƒ¼ãƒ–ãƒ«-preview-ç‰ˆ">RDSâ†’Data Firehoseâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ« (preview ç‰ˆ)</span></h2><pre class="mermaid">graph LRsubgraph AWS Account-A    RDS-->NLB-->VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹endVPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹--CDCãƒ­ã‚°-->VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆsubgraph AWS Account data-platform    VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ-->data_firehose[Data Firehose]-->Icebergend</pre><p>å‚è€ƒ: <a href="https://aws.amazon.com/jp/blogs/news/replicate-changes-from-databases-to-apache-iceberg-tables-using-amazon-data-firehose/">Amazon Data Firehose ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ Apache Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤‰æ›´ã‚’ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆ (ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼)</a></p><ul><li>Pros:<ul><li>é‹ç”¨ãƒ»æ§‹ç¯‰ã‚³ã‚¹ãƒˆå®‰</li><li>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ S3 ä¸Šã® Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã«çµ±åˆã§ãã‚‹</li></ul></li><li>Cons:<ul><li>2024 å¹´ 12 æœˆ 19 æ—¥æ™‚ç‚¹ã§ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ <code>.*</code> ã§æŒ‡å®šã™ã‚‹ã¨å¤šæ•°ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚‹å ´åˆã€å†…éƒ¨ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šå®Ÿé‹ç”¨ã«å‘ã‹ãªã„<ul><li>å•ã„åˆã‚ã›ä¸­</li></ul></li><li>PrivateLink ã®æ§‹ç¯‰ãŒå¿…è¦</li></ul></li></ul><h2><span id="rds-ã‚’å…±æœ‰ã—ã‚¯ãƒ­ãƒ¼ãƒ³">RDS ã‚’å…±æœ‰ã—ã‚¯ãƒ­ãƒ¼ãƒ³</span></h2><pre class="mermaid">graph LRaccount_a[RDS]--å…±æœ‰-->data_platform[RDS]subgraph AWS Account-A    account_a[RDS]endsubgraph AWS data-platform    data_platform[RDS]--ã‚¯ãƒ­ãƒ¼ãƒ³-->cloned[RDS]end</pre><p>RDS ã‚’å…±æœ‰ã—ã€ãã®å…±æœ‰ã•ã‚ŒãŸ RDS ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆã—ã¾ã™ã€‚<br>ã‚¯ãƒ­ãƒ¼ãƒ³å®Ÿæ–½ã•ã‚ŒãŸæ™‚ç‚¹ã®æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã•ã‚ŒãŸ RDS ã§å‚ç…§ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã‚’æ±‚ã‚ã‚‹ã«ã¯é›£ã—ã„æ§‹æˆã§ã™ã€‚</p><ul><li>Pros:<ul><li>ç°¡æ˜“ã«æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒå‚ç…§ã§ãã‚‹</li></ul></li><li>Cons:<ul><li>å®šå¸¸çš„ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«ãƒ‡ãƒ¼ã‚¿ãŒå‚ç…§ã§ããªã„</li><li>è»Œé“ã«å°‘ãªãã¨ã‚‚ 10 åˆ†ç¨‹åº¦ã‹ã‹ã‚‹</li></ul></li></ul><h2><span id="ç·è©•">ç·è©•</span></h2><p>RDSâ†’Data Firehoseâ†’Iceberg (preview ç‰ˆ) ãŒé‹ç”¨ãƒ»æ§‹ç¯‰ã‚³ã‚¹ãƒˆå®‰ã§å¤§å¤‰æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</p><p>æ§˜ã€…æ‰‹æ³•ãŒã‚ã‚‹ä¸­ã§ CDC ã‚’åˆ©ç”¨ã—ãŸ Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®çµ±åˆã¯ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã«ãªã£ã¦ã„ãæµã‚Œã«ã‚ã‚‹ã‹ã¨æ¨å¯Ÿã—ã¾ã™ã€‚</p><p>ä»Šå¾ŒãŒã‚ˆã‚Šæ¥½ã—ã¿ã§ã™ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%82%E8%A6%81&quot;&gt;æ¦‚è¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rdsgluejobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB&quot;&gt;RDSâ†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rds-zero-etl-%E7%B5%B1%E5%90%88-redshift-%E3%81%B8%E3%83%AC%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%83%88&quot;&gt;RDS Zero-ETL çµ±åˆ Redshift ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rdsdmss3gluejobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB&quot;&gt;RDSâ†’DMSâ†’S3â†’GlueJobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rdsdebeziummsks3glue-jobiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB&quot;&gt;RDSâ†’debeziumâ†’MSKâ†’S3â†’Glue Jobâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rdsdata-firehoseiceberg-%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB-preview-%E7%89%88&quot;&gt;RDSâ†’Data Firehoseâ†’Iceberg ãƒ†ãƒ¼ãƒ–ãƒ« (preview ç‰ˆ)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rds-%E3%82%92%E5%85%B1%E6%9C%89%E3%81%97%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%B3&quot;&gt;RDS ã‚’å…±æœ‰ã—ã‚¯ãƒ­ãƒ¼ãƒ³&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E7%B7%8F%E8%A9%95&quot;&gt;ç·è©•&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;h2 id=&quot;æ¦‚è¦&quot;&gt;&lt;a href=&quot;#æ¦‚è¦&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¦&quot;&gt;&lt;/a&gt;æ¦‚è¦&lt;/h2&gt;&lt;p&gt;RDS ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ãŒå¤šæ•°ã‚ã£ãŸã®ã§ãã®ä¸€è¦§ã‚’ã¾ã¨ã‚ã¾ã™ã€‚&lt;/p&gt;
&lt;p&gt;RDS ã‚’ãƒ¦ãƒ¼ã‚¶å½±éŸ¿ã‚’æ¥µåŠ›ä½ãã™ã¹ãã€åˆ†æç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã—ã¦ã€åˆ†æã™ã‚‹æ–¹æ³•ãŒå¤šã€…ã‚ã£ãŸã®ã§ç§è¦‹ã§ã™ãŒ Pros/Cons ã‚’ã¾ã¨ã‚ã¾ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>Glue Job Bookmark æ©Ÿèƒ½ã§ãªã sampleQuery ã‚’ä½¿ã£ã¦ DB ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã¿ãŸ</title>
    <link href="https://kenzo0107.github.io/2024/10/17/2024-10-18-glue-job-bookmark/"/>
    <id>https://kenzo0107.github.io/2024/10/17/2024-10-18-glue-job-bookmark/</id>
    <published>2024-10-17T15:00:00.000Z</published>
    <updated>2024-10-17T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#glue-job-bookmark-%E6%A9%9F%E8%83%BD%E3%81%A8%E3%81%AF">Glue Job Bookmark æ©Ÿèƒ½ã¨ã¯ï¼Ÿ</a></li><li><a href="#glue-job-bookmark-%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9">Glue Job Bookmark ã®å•é¡Œç‚¹</a><ul><li><a href="#%E4%BE%8B-%E4%B8%8D%E6%95%B4%E5%90%88%E3%81%8C%E8%B5%B7%E3%81%93%E3%82%8B%E4%BE%8B">ä¾‹: ä¸æ•´åˆãŒèµ·ã“ã‚‹ä¾‹</a></li></ul></li><li><a href="#%E5%95%8F%E9%A1%8C%E7%82%B9%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C%E7%AD%96">å•é¡Œç‚¹ã¸ã®å¯¾å¿œç­–</a></li><li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">ã¾ã¨ã‚</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>Glue Job ã§ DB ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ãŸéš›ã« Glue Job Bookmark ã‚’åˆ©ç”¨ã—ã¦ã„ãŸéš›ã«å•é¡ŒãŒã‚ã£ãŸã®ã§ã€ãã®éš›ã®å¯¾å¿œã‚’å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¾ã™ã€‚</p><h2><span id="glue-job-bookmark-æ©Ÿèƒ½ã¨ã¯">Glue Job Bookmark æ©Ÿèƒ½ã¨ã¯ï¼Ÿ</span></h2><p>Glue Job ã§ DB ã‚„ãƒ­ã‚°æƒ…å ±ã‚’å–ã‚Šè¾¼ã¿ã—ã¦ã„ã‚‹å ´åˆã€ã©ã“ã¾ã§å–ã‚Šè¾¼ã‚“ã ã‹ã‚’è¨˜éŒ²ã™ã‚‹ <a href="https://docs.aws.amazon.com/ja_jp/glue/latest/dg/monitor-continuations.html">Bookmark æ©Ÿèƒ½</a> ãŒã‚ã‚Šã¾ã™ã€‚</p><p>DB ãƒ‡ãƒ¼ã‚¿ã‚’æ¯å›å…¨ã¦ãƒ€ãƒ³ãƒ—ã™ã‚‹ã‚ˆã‚Šã‚‚å·®åˆ†ã®ã¿æŠ½å‡ºï¼ˆå¢—åˆ†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ: Incremental Exportï¼‰ã§ãã€ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šè¾¼ã¿é‡ã‚‚æŠ‘ãˆã‚‰ã‚Œã€Glue Job ã®å®Ÿè¡Œæ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¾ã™ã€‚</p><p>Glue Job ã¯å®Ÿè¡Œæ™‚é–“ã«å¯¾ã—ã¦å¾“é‡èª²é‡‘ã•ã‚Œã‚‹ã®ã§ã‚³ã‚¹ãƒˆã‚‚æŠ‘åˆ¶ã§ãã‚‹ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚</p><span id="more"></span><h2><span id="glue-job-bookmark-ã®å•é¡Œç‚¹">Glue Job Bookmark ã®å•é¡Œç‚¹</span></h2><p>Glue Job ã® Bookmark ã¯ <code>job.commit()</code> ã•ã‚ŒãŸéš›ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚</p><p>å–ã‚Šè¾¼ã¿å‡¦ç†ä¸­ã«ä¸€éƒ¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—å‡¦ç†ãŒä¸­æ–­ã•ã‚ŒãŸå ´åˆã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†ãŒæˆåŠŸã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã¯ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã¯æ›´æ–°ã•ã‚Œã¾ã™ãŒã€Bookmark ã¯æ›´æ–°ã•ã‚Œãšã€ä¸æ•´åˆãŒç™ºç”Ÿã—ã¾ã™ã€‚</p><h3><span id="ä¾‹-ä¸æ•´åˆãŒèµ·ã“ã‚‹ä¾‹">ä¾‹: ä¸æ•´åˆãŒèµ·ã“ã‚‹ä¾‹</span></h3><ul><li>table1 å‡¦ç†æˆåŠŸ â†’ ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã¯æ›´æ–°ã•ã‚Œã‚‹</li><li>table2 å‡¦ç†æˆåŠŸ â†’ ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã¯æ›´æ–°ã•ã‚Œã‚‹</li><li>table3 å‡¦ç†å¤±æ•— â†’ ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã¯æ›´æ–°ã•ã‚Œãªã„<br>â†’ Bookmark ã¯æ›´æ–°ã•ã‚Œãªã„ã€‚</li></ul><p>å…¨ã¦ã®å‡¦ç†ã§ transaction ã‚’è²¼ã‚‹ã“ã¨ãŒå¯¾ç­–ã§ã¯ã‚ã‚Šã¾ã™ãŒã€å®Ÿè¡Œã‚³ã‚¹ãƒˆãŒé«˜ã„å ´åˆã«ã€å–ã‚Šè¾¼ã‚ãŸåˆ†ã¯å–ã‚Šè¾¼ã‚ãŸåˆ†ã ã‘æ›´æ–°ã—ã¦ã‚‚ã‚‰ã£ãŸæ–¹ãŒå†å®Ÿè¡Œã‚³ã‚¹ãƒˆãŒä½ãã¦è‰¯ã„ã§ã™ã€‚</p><h2><span id="å•é¡Œç‚¹ã¸ã®å¯¾å¿œç­–">å•é¡Œç‚¹ã¸ã®å¯¾å¿œç­–</span></h2><p><code>glue context</code> ã® <code>create_data_frame.from_catalog</code> ã‚’åˆ©ç”¨ã—ã¦æŠ½å‡ºã™ã‚‹éš›ã¯ã€€<code>additional_options[&#39;sampleQuery&#39;]</code> ã‚’åˆ©ç”¨ã—ã€å¢—åˆ†ã‚’æŠ½å‡ºã™ã‚‹ã€è‡ªå‰ Bookmark æ©Ÿèƒ½ã§å¯¾å¿œã—ã¾ã—ãŸã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> is_table_exists:</span><br><span class="line">   <span class="comment"># ãƒ†ãƒ¼ãƒ–ãƒ«ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆ</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># Glue Data Catalog ãƒ†ãƒ¼ãƒ–ãƒ«ã® bookmark key ã«è¨­å®šã—ãŸã‚«ãƒ©ãƒ ã®æœ€å¤§å€¤å–å¾—</span></span><br><span class="line">   df = self.glueContext.create_data_frame.from_catalog(database=dest_database, table_name=dest_table)</span><br><span class="line">   max_value = df.agg(&#123;bookmark_key: <span class="string">&quot;max&quot;</span>&#125;).collect()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">   <span class="comment"># sampleQuery ã‚’åˆ©ç”¨ã—å¢—åˆ†ã®ã¿å–å¾—</span></span><br><span class="line">   datasource = self.glueContext.create_dynamic_frame.from_catalog(</span><br><span class="line">      ...</span><br><span class="line">      additional_options=&#123;</span><br><span class="line">            <span class="string">&#x27;sampleQuery&#x27;</span>: <span class="string">f&quot;SELECT * FROM <span class="subst">&#123;source_database&#125;</span>.<span class="subst">&#123;source_table&#125;</span> WHERE <span class="subst">&#123;bookmark_key&#125;</span> &gt; <span class="subst">&#123;max_value&#125;</span> AND&quot;</span>,</span><br><span class="line">            ...</span><br><span class="line">      &#125;</span><br><span class="line">   )</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã«ã‚ˆã‚Š Bookmark æ©Ÿèƒ½ã‚’åˆ©ç”¨ã›ãšã¨ã‚‚å·®åˆ†æŠ½å‡ºã‚’ã§ãã‚‹ã‚ˆã†ã«å¯¾ç­–ã—ã¾ã—ãŸã€‚</p><p>ã¡ãªã¿ã«ã‚¯ã‚¨ãƒªã®æœ€å¾Œã« <code>AND</code> ãŒã‚ã‚‹ã®ã¯ã€<code>enablePartitioningForSampleQuery: true</code> ã«ã—ã€JDBC ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ä¸¦åˆ—ã§èª­ã¿è¾¼ã‚€è¨­å®šã‚’ã—ã¦ã„ã‚‹ç‚ºã§ã™ã€‚</p><h2><span id="ã¾ã¨ã‚">ã¾ã¨ã‚</span></h2><ul><li>sampleQuery ã®æ–¹ãŒ Bookmark æ©Ÿèƒ½ã‚ˆã‚Šå¢—åˆ†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¯ã—ã‚„ã™ã„å°è±¡<ul><li>DB è² è·ã‚’æŠ‘ãˆãªãŒã‚‰å–ã‚Šè¾¼ã‚€ã“ã¨ã‚‚ã§ãã‚‹ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚‹</li></ul></li><li>Glue Job Bookmark ã¯æ›´æ–° API ç­‰ã¯ãªãã€Glue Job ã®å®Ÿè¡ŒæˆåŠŸã§ã®ã¿æ›´æ–°ã•ã‚Œã‚‹ã®ã§ã€å¤±æ•—ã—ãŸå ´åˆã¯å…¨ã¦ã‚’å¤±æ•—ã¨è¦‹ãªã™ã—ã‹ãªã•ãã†<ul><li>ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¥ã‚‰ã„</li></ul></li></ul><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°ä½•ã‚ˆã‚Šã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%82%E8%A6%81&quot;&gt;æ¦‚è¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#glue-job-bookmark-%E6%A9%9F%E8%83%BD%E3%81%A8%E3%81%AF&quot;&gt;Glue Job Bookmark æ©Ÿèƒ½ã¨ã¯ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#glue-job-bookmark-%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9&quot;&gt;Glue Job Bookmark ã®å•é¡Œç‚¹&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E4%BE%8B-%E4%B8%8D%E6%95%B4%E5%90%88%E3%81%8C%E8%B5%B7%E3%81%93%E3%82%8B%E4%BE%8B&quot;&gt;ä¾‹: ä¸æ•´åˆãŒèµ·ã“ã‚‹ä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%95%8F%E9%A1%8C%E7%82%B9%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C%E7%AD%96&quot;&gt;å•é¡Œç‚¹ã¸ã®å¯¾å¿œç­–&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%81%BE%E3%81%A8%E3%82%81&quot;&gt;ã¾ã¨ã‚&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;h2 id=&quot;æ¦‚è¦&quot;&gt;&lt;a href=&quot;#æ¦‚è¦&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¦&quot;&gt;&lt;/a&gt;æ¦‚è¦&lt;/h2&gt;&lt;p&gt;Glue Job ã§ DB ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ãŸéš›ã« Glue Job Bookmark ã‚’åˆ©ç”¨ã—ã¦ã„ãŸéš›ã«å•é¡ŒãŒã‚ã£ãŸã®ã§ã€ãã®éš›ã®å¯¾å¿œã‚’å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¾ã™ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Glue-Job-Bookmark-æ©Ÿèƒ½ã¨ã¯ï¼Ÿ&quot;&gt;&lt;a href=&quot;#Glue-Job-Bookmark-æ©Ÿèƒ½ã¨ã¯ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Glue Job Bookmark æ©Ÿèƒ½ã¨ã¯ï¼Ÿ&quot;&gt;&lt;/a&gt;Glue Job Bookmark æ©Ÿèƒ½ã¨ã¯ï¼Ÿ&lt;/h2&gt;&lt;p&gt;Glue Job ã§ DB ã‚„ãƒ­ã‚°æƒ…å ±ã‚’å–ã‚Šè¾¼ã¿ã—ã¦ã„ã‚‹å ´åˆã€ã©ã“ã¾ã§å–ã‚Šè¾¼ã‚“ã ã‹ã‚’è¨˜éŒ²ã™ã‚‹ &lt;a href=&quot;https://docs.aws.amazon.com/ja_jp/glue/latest/dg/monitor-continuations.html&quot;&gt;Bookmark æ©Ÿèƒ½&lt;/a&gt; ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;p&gt;DB ãƒ‡ãƒ¼ã‚¿ã‚’æ¯å›å…¨ã¦ãƒ€ãƒ³ãƒ—ã™ã‚‹ã‚ˆã‚Šã‚‚å·®åˆ†ã®ã¿æŠ½å‡ºï¼ˆå¢—åˆ†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ: Incremental Exportï¼‰ã§ãã€ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šè¾¼ã¿é‡ã‚‚æŠ‘ãˆã‚‰ã‚Œã€Glue Job ã®å®Ÿè¡Œæ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¾ã™ã€‚&lt;/p&gt;
&lt;p&gt;Glue Job ã¯å®Ÿè¡Œæ™‚é–“ã«å¯¾ã—ã¦å¾“é‡èª²é‡‘ã•ã‚Œã‚‹ã®ã§ã‚³ã‚¹ãƒˆã‚‚æŠ‘åˆ¶ã§ãã‚‹ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>asdf ã§ ruby ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚‰ãªã„æ™‚</title>
    <link href="https://kenzo0107.github.io/2024/09/02/2024-09-03-asdf-plugin-update-ruby/"/>
    <id>https://kenzo0107.github.io/2024/09/02/2024-09-03-asdf-plugin-update-ruby/</id>
    <published>2024-09-02T15:00:00.000Z</published>
    <updated>2024-09-02T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E5%AF%BE%E7%AD%96-asdf-ruby-plugin-%E3%82%92%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B">å¯¾ç­–: asdf ruby plugin ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹</a></li><li><a href="#%E5%86%8D%E5%BA%A6%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%AA%E3%82%B9%E3%83%88%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B">å†åº¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹</a></li></ul><!-- tocstop --></div></div><hr><p>asdf ã§ ruby ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ©ç”¨ã—ãŸã‹ã£ãŸã‘ã©ã€ãƒªã‚¹ãƒˆã«ãªãã¦å›°ã£ãŸæ™‚ã®è©±ã§ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf list all ruby</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">3.1.0</span><br><span class="line">3.1.1</span><br><span class="line">3.1.2</span><br><span class="line">3.1.3</span><br><span class="line">3.2.0-dev</span><br><span class="line">3.2.0-preview1</span><br><span class="line">3.2.0-preview2</span><br><span class="line">3.2.0-preview3</span><br><span class="line">3.2.0-rc1</span><br><span class="line">3.2.0</span><br><span class="line">3.3.0-dev</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>3.3.0 ä»¥ä¸Šã‚’åˆ©ç”¨ã—ãŸã„ã®ã«å‡ºã¦ã“ãªã„ğŸ’¦</p><span id="more"></span><h2><span id="å¯¾ç­–-asdf-ruby-plugin-ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹">å¯¾ç­–: asdf ruby plugin ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹</span></h2><p><a href="https://github.com/asdf-vm/asdf-ruby?tab=readme-ov-file#use">asdf-ruby - Use</a> ã‚’å‚è€ƒã«<br>plugin ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf plugin-update ruby</span></span><br><span class="line"></span><br><span class="line">Updating ruby to master</span><br><span class="line">From https://github.com/asdf-vm/asdf-ruby</span><br><span class="line">   16bc8ac..d6eb414  master     -&gt; master</span><br><span class="line">   16bc8ac..d6eb414  master     -&gt; origin/master</span><br><span class="line">Already on &#x27;master&#x27;</span><br><span class="line">Your branch is up to date with &#x27;origin/master&#x27;.</span><br></pre></td></tr></table></figure><h2><span id="å†åº¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹">å†åº¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf list all ruby</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">3.3.0-rc1</span><br><span class="line">3.3.0</span><br><span class="line">3.3-dev</span><br><span class="line">3.3.1</span><br><span class="line">3.3.2</span><br><span class="line">3.3.3</span><br><span class="line">3.3.4</span><br><span class="line">3.3.5</span><br><span class="line">3.4.0-preview1</span><br><span class="line">3.4-dev</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ç„¡äº‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã—ãŸã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf install ruby 3.3.5</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%AF%BE%E7%AD%96-asdf-ruby-plugin-%E3%82%92%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B&quot;&gt;å¯¾ç­–: asdf ruby plugin ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%86%8D%E5%BA%A6%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%AA%E3%82%B9%E3%83%88%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B&quot;&gt;å†åº¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;asdf ã§ ruby ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ©ç”¨ã—ãŸã‹ã£ãŸã‘ã©ã€ãƒªã‚¹ãƒˆã«ãªãã¦å›°ã£ãŸæ™‚ã®è©±ã§ã™ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight console&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta prompt_&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;language-bash&quot;&gt;asdf list all ruby&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.1.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.1.2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.1.3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0-dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0-preview1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0-preview2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0-preview3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0-rc1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.3.0-dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;3.3.0 ä»¥ä¸Šã‚’åˆ©ç”¨ã—ãŸã„ã®ã«å‡ºã¦ã“ãªã„ğŸ’¦&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Error: Docker is unreachable. Docker needs to be running to build inside a container.</title>
    <link href="https://kenzo0107.github.io/2024/08/26/2024-08-27-docker-is-unreachable/"/>
    <id>https://kenzo0107.github.io/2024/08/26/2024-08-27-docker-is-unreachable/</id>
    <published>2024-08-26T15:00:00.000Z</published>
    <updated>2024-08-26T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#docker_host-%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B">DOCKER_HOST ã‚’æŒ‡å®šã™ã‚‹</a></li></ul><!-- tocstop --></div></div><hr><p><code>sam build --use-container</code> ã§ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œã—ãŸéš›ã«ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Docker is unreachable. Docker needs to be running to build inside a container.</span><br></pre></td></tr></table></figure><span id="more"></span><h2><span id="docker_host-ã‚’æŒ‡å®šã™ã‚‹">DOCKER_HOST ã‚’æŒ‡å®šã™ã‚‹</span></h2><p>ç¾åœ¨ã® Context ã‚’ç¢ºèªã—ã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker info | grep <span class="string">&#x27;Context:&#x27;</span></span></span><br><span class="line"></span><br><span class="line"> Context:    desktop-linux</span><br></pre></td></tr></table></figure><p>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèªã—ã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker context <span class="built_in">ls</span> | grep desktop-linux</span></span><br><span class="line"></span><br><span class="line">desktop-linux *     moby                Docker Desktop                            unix:///Users/kenzo.tanaka/.docker/run/docker.sock</span><br></pre></td></tr></table></figure><p>DOCKER_HOST ã‚’æŒ‡å®šã—å†åº¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ã‚’å›é¿ã§ãã¾ã—ãŸã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">env</span> SAM_CLI_TELEMETRY=0 \</span></span><br><span class="line"><span class="language-bash">    DOCKER_HOST=unix:///Users/kenzo.tanaka/.docker/run/docker.sock \</span></span><br><span class="line"><span class="language-bash">    sam build --use-container --cached --parallel</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã¾ã§</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#docker_host-%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B&quot;&gt;DOCKER_HOST ã‚’æŒ‡å®šã™ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;&lt;code&gt;sam build --use-container&lt;/code&gt; ã§ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œã—ãŸéš›ã«ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Error: Docker is unreachable. Docker needs to be running to build inside a container.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>GitHub Profile Status ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ (busy è§£é™¤)</title>
    <link href="https://kenzo0107.github.io/2024/06/23/2024-06-24-clear-github-profile-status/"/>
    <id>https://kenzo0107.github.io/2024/06/23/2024-06-24-clear-github-profile-status/</id>
    <published>2024-06-23T15:00:00.000Z</published>
    <updated>2024-06-23T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>GitHub ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã® busy ã‚’è§£é™¤ã—ãŸã„æ™‚ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><script src="//gist.github.com/kenzo0107/c14af761680ca725e807d29bc090d3bd.js"></script><p>ä»¥ä¸Š<br>å‚è€ƒã¾ã§</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GitHub ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã® busy ã‚’è§£é™¤ã—ãŸã„æ™‚ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
&lt;script src=&quot;//gist.github.com/kenzo0107/c14af761680ca725e807d29bc090d3bd.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;ä»¥ä¸Š&lt;</summary>
      
    
    
    
    <category term="Git" scheme="https://kenzo0107.github.io/categories/Git/"/>
    
    
  </entry>
  
  <entry>
    <title>ALB ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã«æ–°ãŸãªé …ç›®ãŒè¿½åŠ ã•ã‚ŒãŸ</title>
    <link href="https://kenzo0107.github.io/2024/05/28/2024-05-29-upgrade-alb-accesslog-format/"/>
    <id>https://kenzo0107.github.io/2024/05/28/2024-05-29-upgrade-alb-accesslog-format/</id>
    <published>2024-05-28T15:00:00.000Z</published>
    <updated>2024-05-28T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>2024.05.22 ã‚ˆã‚Šã€ALB ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ Athena ã§ã‚¯ã‚¨ãƒªå®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ç©ºã®è¡ŒãŒè¿”ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚<br>åŸå› ã‚’èª¿æŸ»ã—ã¦ã¿ã‚‹ã¨ã©ã†ã‚„ã‚‰ ALB ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã«ä»¥ä¸‹ã®é …ç›®ãŒè¿½åŠ ã•ã‚Œã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒå¤‰æ›´ã•ã‚ŒãŸç‚ºã®ã‚ˆã†ã§ã™ã€‚</p><ul><li>traceability_id string</li><li>unknown_fields string</li></ul><p>ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å†ä½œæˆã™ã‚‹ã“ã¨ã§äº‹ãªãã‚’å¾—ã¾ã—ãŸã€‚</p><p>â€» ALB ã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã—ã¦åˆ©ç”¨ã—ã¦ãŠã‚Šã€<a href="https://docs.aws.amazon.com/athena/latest/ug/application-load-balancer-logs.html">å…¬å¼</a>ã¨ã¯ã‚„ã‚„ç•°ãªã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã«ã—ã¦ã„ã¾ã™ã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE `&lt;table name&gt;`(</span><br><span class="line">  `type` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `time` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `elb` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `client_ip` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `client_port` int COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_ip` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_port` int COMMENT &#x27;&#x27;,</span><br><span class="line">  `request_processing_time` double COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_processing_time` double COMMENT &#x27;&#x27;,</span><br><span class="line">  `response_processing_time` double COMMENT &#x27;&#x27;,</span><br><span class="line">  `elb_status_code` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_status_code` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `received_bytes` bigint COMMENT &#x27;&#x27;,</span><br><span class="line">  `sent_bytes` bigint COMMENT &#x27;&#x27;,</span><br><span class="line">  `request_verb` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `request_url` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `request_proto` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `user_agent` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `ssl_cipher` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `ssl_protocol` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_group_arn` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `trace_id` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `domain_name` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `chosen_cert_arn` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `matched_rule_priority` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `request_creation_time` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `actions_executed` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `redirect_url` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `lambda_error_reason` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_port_list` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `target_status_code_list` string COMMENT &#x27;&#x27;,</span><br><span class="line">  `classification` string COMMENT &#x27;&#x27;,</span><br><span class="line"><span class="deletion">-  `classification_reason` string COMMENT &#x27;&#x27;</span></span><br><span class="line"><span class="addition">+  `classification_reason` string COMMENT &#x27;&#x27;,</span></span><br><span class="line"><span class="addition">+  `traceability_id` string COMMENT &#x27;&#x27;,</span></span><br><span class="line"><span class="addition">+  `unknown_fields` string COMMENT &#x27;&#x27;</span></span><br><span class="line">)</span><br><span class="line">PARTITIONED BY (</span><br><span class="line">  `year` int COMMENT &#x27;&#x27;,</span><br><span class="line">  `month` int COMMENT &#x27;&#x27;,</span><br><span class="line">  `day` int COMMENT &#x27;&#x27;)</span><br><span class="line">ROW FORMAT SERDE &#x27;org.apache.hadoop.hive.serde2.RegexSerDe&#x27;</span><br><span class="line">WITH SERDEPROPERTIES (</span><br><span class="line"><span class="deletion">-  &#x27;input.regex&#x27; =</span></span><br><span class="line"><span class="deletion">-        &#x27;([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*):([0-9]*) ([^ ]*)[:-]([0-9]*) ([-.0-9]*) ([-.0-9]*) ([-.0-9]*) (|[-0-9]*) (-|[-0-9]*) ([-0-9]*) ([-0-9]*) \&quot;([^ ]*) (.*) (- |[^ ]*)\&quot; \&quot;([^\&quot;]*)\&quot; ([A-Z0-9-_]+) ([A-Za-z0-9.-]*) ([^ ]*) \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; ([-.0-9]*) ([^ ]*) \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; \&quot;([^ ]*)\&quot; \&quot;([^\s]+?)\&quot; \&quot;([^\s]+)\&quot; \&quot;([^ ]*)\&quot; \&quot;([^ ]*)\&quot;&#x27;)</span></span><br><span class="line"><span class="addition">+  &#x27;input.regex&#x27; =</span></span><br><span class="line"><span class="addition">+        &#x27;([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*):([0-9]*) ([^ ]*)[:-]([0-9]*) ([-.0-9]*) ([-.0-9]*) ([-.0-9]*) (|[-0-9]*) (-|[-0-9]*) ([-0-9]*) ([-0-9]*) \&quot;([^ ]*) (.*) (- |[^ ]*)\&quot; \&quot;([^\&quot;]*)\&quot; ([A-Z0-9-_]+) ([A-Za-z0-9.-]*) ([^ ]*) \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; ([-.0-9]*) ([^ ]*) \&quot;([^\&quot;]*)\&quot; \&quot;([^\&quot;]*)\&quot; \&quot;([^ ]*)\&quot; \&quot;([^\s]+?)\&quot; \&quot;([^\s]+)\&quot; \&quot;([^ ]*)\&quot; \&quot;([^ ]*)\&quot; ?([^ ]*)?&#x27;)</span></span><br><span class="line">STORED AS INPUTFORMAT</span><br><span class="line">  &#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><br><span class="line">OUTPUTFORMAT</span><br><span class="line">  &#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><br><span class="line">LOCATION</span><br><span class="line">  &#x27;s3://&lt;s3 bucket&gt;/&lt;lb name&gt;/AWSLogs/&lt;aws account id&gt;/elasticloadbalancing/ap-northeast-1&#x27;</span><br><span class="line">TBLPROPERTIES (</span><br><span class="line">  &#x27;classification&#x27;=&#x27;csv&#x27;,</span><br><span class="line">  &#x27;compressionType&#x27;=&#x27;gzip&#x27;,</span><br><span class="line">  &#x27;projection.day.digits&#x27;=&#x27;2&#x27;,</span><br><span class="line">  &#x27;projection.day.range&#x27;=&#x27;01,31&#x27;,</span><br><span class="line">  &#x27;projection.day.type&#x27;=&#x27;integer&#x27;,</span><br><span class="line">  &#x27;projection.enabled&#x27;=&#x27;true&#x27;,</span><br><span class="line">  &#x27;projection.month.digits&#x27;=&#x27;2&#x27;,</span><br><span class="line">  &#x27;projection.month.range&#x27;=&#x27;01,12&#x27;,</span><br><span class="line">  &#x27;projection.month.type&#x27;=&#x27;integer&#x27;,</span><br><span class="line">  &#x27;projection.year.digits&#x27;=&#x27;4&#x27;,</span><br><span class="line">  &#x27;projection.year.range&#x27;=&#x27;2020,2100&#x27;,</span><br><span class="line">  &#x27;projection.year.type&#x27;=&#x27;integer&#x27;,</span><br><span class="line">  &#x27;storage.location.template&#x27;=&#x27;s3://&lt;s3 bucket&gt;/&lt;lb name&gt;/AWSLogs/&lt;aws account id&gt;/elasticloadbalancing/ap-northeast-1/$&#123;year&#125;/$&#123;month&#125;/$&#123;day&#125;&#x27;,</span><br><span class="line">  &#x27;typeOfData&#x27;=&#x27;file&#x27;)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2024.05.22 ã‚ˆã‚Šã€ALB ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ Athena ã§ã‚¯ã‚¨ãƒªå®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ç©ºã®è¡ŒãŒè¿”ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚&lt;br&gt;åŸå› ã‚’èª¿æŸ»ã—ã¦ã¿ã‚‹ã¨ã©ã†ã‚„ã‚‰ ALB ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã«ä»¥ä¸‹ã®é …ç›®ãŒè¿½åŠ ã•ã‚Œã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒå¤‰æ›´ã•ã‚ŒãŸç‚ºã®ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tra</summary>
      
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>Python ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</title>
    <link href="https://kenzo0107.github.io/2024/05/27/2024-05-28-read-file-by-python/"/>
    <id>https://kenzo0107.github.io/2024/05/27/2024-05-28-read-file-by-python/</id>
    <published>2024-05-27T15:00:00.000Z</published>
    <updated>2024-05-27T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><!-- tocstop --></div></div><hr><p>Python ã§ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’èª­ã¿è¾¼ã¿ã—ã¦ Azure OpenAI Service ã«èª­ã¾ã›ãŸã„æ™‚ãŒã‚ã£ãŸã®ã§ã¾ã¨ã‚ã¾ã—ãŸã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"><span class="keyword">from</span> pypdf <span class="keyword">import</span> PdfReader</span><br><span class="line"></span><br><span class="line"><span class="comment"># .docx</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_docx</span>(<span class="params">filepath</span>):</span><br><span class="line">    doc = Document(filepath)</span><br><span class="line">    full_text = []</span><br><span class="line">    <span class="keyword">for</span> para <span class="keyword">in</span> doc.paragraphs:</span><br><span class="line">        full_text.append(para.text)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;\n&quot;</span>.join(full_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># .pdf</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_pdf</span>(<span class="params">filepath</span>):</span><br><span class="line">    reader = PdfReader(filepath)</span><br><span class="line">    full_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> reader.pages:</span><br><span class="line">        full_text += p.extract_text()</span><br><span class="line">    <span class="keyword">return</span> full_text</span><br><span class="line"></span><br><span class="line"><span class="comment"># .txt, .md etc...</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_txt</span>(<span class="params">filepath</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        content = file.read()</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">filepath</span>):</span><br><span class="line">    _, ext = os.path.splitext(filepath)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ext == <span class="string">&#x27;.docx&#x27;</span>:</span><br><span class="line">        t = read_docx(filepath)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">&#x27;.pdf&#x27;</span>:</span><br><span class="line">        t = read_pdf(filepath)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t = read_txt(filepath)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    filepath = sys.argv[<span class="number">1</span>]</span><br><span class="line">    main(filepath)</span><br></pre></td></tr></table></figure><p><a href="https://gist.github.com/kenzo0107/456439de57b3640c053cf369ca42f358">https://gist.github.com/kenzo0107/456439de57b3640c053cf369ca42f358</a></p><p>ä»¥å‰ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’ 1 è¡Œãšã¤ã€yaml ã‚’ãƒ‘ãƒ¼ã‚¹ç­‰ã¯å®Ÿæ–½ã—ã¾ã—ãŸã®ã§ã€ãã¡ã‚‰ã‚‚å‚è€ƒã¾ã§ã€‚</p><a href="https://kenzo0107.github.io/2023/07/20/2023-07-21-python-load-file/#more" class="link-preview" target="_blank"><div class="link-area"><div class="og-image"><img src="https://i.imgur.com/V4yCTSm.png"></div><div class="descriptions"><div class="og-title">python ã§ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—ã™ã‚‹</div><div class="og-description">ToC     æ¦‚è¦ ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨æ„ ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾— ãƒ•ã‚¡ã‚¤ãƒ«ã® 1 è¡Œç›®ã®ã¿å–å¾— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡Œæ¯ã«å–å¾— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã— Yaml ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚‹</div></div></div></a><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;&lt;span id=&quot;toc&quot;&gt;ToC&lt;/span&gt;&lt;/h3&gt;

&lt;!-- toc --&gt;



&lt;!-- tocstop --&gt;

&lt;/div&gt;
</summary>
      
    
    
    
    <category term="Python" scheme="https://kenzo0107.github.io/categories/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>AWS ãƒªã‚½ãƒ¼ã‚¹ã®å¹´é–“äºˆç´„è³¼å…¥</title>
    <link href="https://kenzo0107.github.io/2023/12/06/2023-12-07-annual-subscription-purchase-of-aws-resources/"/>
    <id>https://kenzo0107.github.io/2023/12/06/2023-12-07-annual-subscription-purchase-of-aws-resources/</id>
    <published>2023-12-06T15:00:00.000Z</published>
    <updated>2023-12-06T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E5%B9%B4%E9%96%93%E4%BA%88%E7%B4%84%E8%B3%BC%E5%85%A5%E3%81%BE%E3%81%A8%E3%82%81">å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚</a></li><li><a href="#ri-%E6%9C%9F%E9%99%90%E5%88%87%E3%82%8C%E9%80%9A%E7%9F%A5-%E8%A8%AD%E5%AE%9A">RI æœŸé™åˆ‡ã‚Œé€šçŸ¥ è¨­å®š</a></li><li><a href="#reserved-instance-%E8%B3%BC%E5%85%A5%E5%89%8D%E5%BE%8C%E3%81%AE%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D%E3%81%AE%E8%A8%88%E7%AE%97">Reserved Instance è³¼å…¥å‰å¾Œã®ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã®è¨ˆç®—</a></li><li><a href="#savings-plans-%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D-%E8%A8%88%E7%AE%97">Savings Plans ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ è¨ˆç®—</a><ul><li><a href="#aws-savings-plans-%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%80%A4%E6%8E%A8%E5%A5%A8%E5%80%A4%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88">AWS Savings Plans ã‚³ãƒŸãƒƒãƒˆå€¤æ¨å¥¨å€¤ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ</a></li><li><a href="#aws-savings-plans-%E8%87%AA%E5%89%8D%E3%81%A7%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%80%A4%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88">AWS Savings Plans è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹å ´åˆ</a></li></ul></li><li><a href="#cloudfront-security-bundle-%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D">CloudFront Security Bundle ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡</a></li></ul><!-- tocstop --></div></div><hr><p>AWS ãƒªã‚½ãƒ¼ã‚¹ã®å¹´é–“äºˆç´„è³¼å…¥ã«ã¤ã„ã¦å‚™å¿˜éŒ²ã§ã™ã€‚</p><h2><span id="å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚">å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚</span></h2><ul><li><p>Reserved Instance</p><ul><li>å¯¾è±¡:<ul><li>RDS</li><li>ElastiCache</li><li>RedShift</li><li>OpenSearch</li></ul></li><li>ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥<ul><li>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—</li><li>å€‹æ•°</li><li>å‰æ‰•ã„</li><li>å¹´æ•°ï¼ˆå¼Šç¤¾ã¯ 1 å¹´æŒ‡å®šï¼‰</li></ul></li><li>æœŸé™åˆ‡ã‚Œé€šçŸ¥<ul><li><a href="https://us-east-1.console.aws.amazon.com/cost-management/home#/ri/alert">RI ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†</a> ã§è¨­å®š</li></ul></li><li>Pros:<ul><li>ã©ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦è³¼å…¥ã™ã‚‹ã‹ãŒæ±ºå®šã—ã‚„ã™ã„</li></ul></li></ul></li><li><p>Savings Plans</p><ul><li>å¯¾è±¡: ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ï¼ˆEC2 å°‚ç”¨ã® Savings Plans ã‚‚ã‚ã‚‹ï¼‰<ul><li>EC2</li><li>ECS</li><li>Lambda</li></ul></li><li>ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥<ul><li>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®åˆ©ç”¨é‡ã«å¯¾ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆå€¤</li><li>å¹´æ•°</li><li>å‰æ‰•ã„</li></ul></li><li>æœŸé™åˆ‡ã‚Œé€šçŸ¥<ul><li><a href="https://us-east-1.console.aws.amazon.com/cost-management/home#/savings-plans/overview/alert">Savings Plans ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†</a> ã§è¨­å®š</li></ul></li><li>ã‚³ãƒŸãƒƒãƒˆå€¤<ul><li>éå»ãƒ»ä»Šå¾Œã®æ¨å®šåˆ©ç”¨é‡ã‹ã‚‰ç®—å‡ºã™ã‚‹ or AWS æ¨å¥¨å€¤ã‚’è¨­å®šã™ã‚‹</li></ul></li><li>Pros:<ul><li>EC2 ã‹ã‚‰ ECS ã®ãƒªãƒ—ãƒ¬ã‚¤ã‚¹å¾Œã‚‚é©ç”¨ã•ã‚Œã‚‹</li></ul></li><li>Cons:<ul><li>ã©ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦è³¼å…¥ã—ãŸã‹ãŒåˆ†ã‹ã‚Šã¥ã‚‰ã„</li></ul></li></ul></li><li><p>CloudFront Security Bundle</p><ul><li>å¯¾è±¡:<ul><li>CloudFront</li><li>WAF</li></ul></li><li>ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥<ul><li>CloudFront ã®åˆ©ç”¨é‡ã«å¯¾ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆå€¤</li><li>å¹´æ•°</li><li>å‰æ‰•ã„</li></ul></li><li>æœŸé™åˆ‡ã‚Œé€šçŸ¥<ul><li>ç¾çŠ¶ãªã„ (2023-12-07 æ™‚ç‚¹)</li></ul></li><li>ã‚³ãƒŸãƒƒãƒˆå€¤<ul><li>éå»ãƒ»ä»Šå¾Œã®æ¨å®šåˆ©ç”¨é‡ã‹ã‚‰ç®—å‡ºã™ã‚‹ or AWS æ¨å¥¨å€¤ã‚’è¨­å®šã™ã‚‹</li></ul></li></ul></li></ul><span id="more"></span><h2><span id="ri-æœŸé™åˆ‡ã‚Œé€šçŸ¥-è¨­å®š">RI æœŸé™åˆ‡ã‚Œé€šçŸ¥ è¨­å®š</span></h2><p>RI ã®æœŸé™ãŒåˆ‡ã‚Œã‚‹ã¨ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰æ–™é‡‘ã¨ãªã‚Šã‚³ã‚¹ãƒˆå¢—ã¨ãªã‚Šã¾ã™ã€‚<br>ã‚³ã‚¹ãƒˆãŒä¸ŠãŒã£ã¦ã‹ã‚‰æ°—ã¥ãã€ã¨ã„ã†ã“ã¨ãŒãªã„ã‚ˆã†ã«æœŸé™åˆ‡ã‚Œå‰ã«é€šçŸ¥ã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ä»¥ä¸‹ãƒšãƒ¼ã‚¸ã‹ã‚‰è¨­å®šã§ãã¾ã™ã€‚</p><ul><li><p><a href="https://us-east-1.console.aws.amazon.com/cost-management/home#/ri/alert">RI ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†</a><br><img src="https://i.imgur.com/Kq3llTo.png"><br><img src="https://i.imgur.com/cnwPI8X.png"></p></li><li><p>On the day of expiration: æœŸé™åˆ‡ã‚Œå½“æ—¥</p></li><li><p>7 days: æœŸé™åˆ‡ã‚Œ 7 æ—¥å‰</p></li><li><p>30 days: æœŸé™åˆ‡ã‚Œ 30 æ—¥å‰</p></li><li><p>60 days: æœŸé™åˆ‡ã‚Œ 60 æ—¥å‰</p></li><li><p>Email recipients: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã¯ <code>,</code> ã§åŒºåˆ‡ã‚‹</p><ul><li>Slack Email ã‚¢ãƒ—ãƒªã§ç™ºè¡Œã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã¨ Slack é€šçŸ¥ã§ãã‚‹</li></ul></li></ul><h2><span id="reserved-instance-è³¼å…¥å‰å¾Œã®ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã®è¨ˆç®—">Reserved Instance è³¼å…¥å‰å¾Œã®ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã®è¨ˆç®—</span></h2><p>RI ã¯ä»¥ä¸‹ã§å¹´é–“ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã‚’è¨ˆç®—ã§ãã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰æ–™é‡‘/hour Ã— 365 days Ã— 24 hours - (RIå‰æ‰•ã„æ–™é‡‘ + RI é©ç”¨å¾Œæ–™é‡‘/hour Ã— 365 days Ã— 24 hours)</span><br></pre></td></tr></table></figure><p>RDS, ElastiCache, RedShift ã®å„æ–™é‡‘ã¯ AWS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ç¢ºèªå¯èƒ½ã§ã™ã€‚</p><ul><li><a href="https://aws.amazon.com/jp/rds/aurora/pricing/#Aurora_MySQL-Compatible_Edition">Aurora MySQL</a></li><li><a href="https://aws.amazon.com/jp/rds/aurora/pricing/#Aurora_PostgreSQL-Compatible_Edition">Aurora PostgreSQL</a></li><li><a href="https://aws.amazon.com/jp/rds/mysql/pricing/#RDS_for_MySQL">MySQL</a></li><li><a href="https://aws.amazon.com/jp/rds/postgresql/pricing/#RDS_for_PostgreSQL">PostgreSQL</a></li><li><a href="https://aws.amazon.com/jp/elasticache/pricing/#Reserved_nodes">ElastiCache</a></li><li><a href="https://aws.amazon.com/jp/redshift/pricing/#Reserved_Instance_pricing">RedShift</a></li></ul><h2><span id="savings-plans-ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡-è¨ˆç®—">Savings Plans ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ è¨ˆç®—</span></h2><h3><span id="aws-savings-plans-ã‚³ãƒŸãƒƒãƒˆå€¤æ¨å¥¨å€¤ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ">AWS Savings Plans ã‚³ãƒŸãƒƒãƒˆå€¤æ¨å¥¨å€¤ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ</span></h3><p>ä»¥ä¸‹ãƒšãƒ¼ã‚¸ã§ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã®çµæœãŒç¢ºèªã§ãã¾ã™ã€‚</p><ul><li><p><a href="https://us-east-1.console.aws.amazon.com/cost-management/home#/savings-plans/recommendations?lookbackPeriodInDays=SEVEN_DAYS&paymentOption=ALL_UPFRONT&scope=PAYER&spType=COMPUTE_SP&termInYears=ONE_YEAR&tokens=%5B%5D">AWS Savings Plans æ¨å¥¨å€¤</a><br><img src="https://i.imgur.com/vBbJUik.png"></p></li><li><p>Savings Plans type: ç¯€ç´„ãƒ—ãƒ©ãƒ³ã‚¿ã‚¤ãƒ—</p><ul><li>Compute Savings Plans: ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ç¯€ç´„ãƒ—ãƒ©ãƒ³<ul><li>å¯¾è±¡:<ul><li>EC2</li><li>ECS</li><li>Lambda</li></ul></li><li>EC2 ã‹ã‚‰ ECS ã¸ãƒªãƒ—ãƒ¬ã‚¤ã‚¹ã‚’æ¤œè¨ã—ã¦ã„ã‚‹ã€ã¨ã„ã†å ´åˆã«æœ‰åˆ©</li></ul></li><li>EC2 Instance Savings Plans: EC2 ã«å¯¾ã™ã‚‹ç¯€ç´„ãƒ—ãƒ©ãƒ³<ul><li>å¯¾è±¡:<ul><li>EC2</li></ul></li><li>EC2 ã«ç‰¹åŒ–ã—ã¦ã„ã‚‹ãŸã‚ Compute Savings Plans ã‚ˆã‚Šã‚³ã‚¹ãƒˆå‰Šæ¸›ã§ãã‚‹</li></ul></li><li>SageMaker Savings Plans: SageMaker ã«å¯¾ã™ã‚‹ç¯€ç´„ãƒ—ãƒ©ãƒ³<ul><li>å¯¾è±¡:<ul><li>SageMaker</li></ul></li></ul></li></ul></li><li><p>Term: äºˆç´„è³¼å…¥ã™ã‚‹æœŸé–“ (æœ€ä½ 1 å¹´)</p><ul><li>3-year: 3 å¹´ã®äºˆç´„è³¼å…¥ (æœ€ã‚‚ã‚³ã‚¹ãƒˆå‰Šæ¸›ç‡ãŒé«˜ã„)<ul><li>3 å¹´å¾Œã¾ã§ç¾çŠ¶ã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆãŒè¦‹è¾¼ã‚ãªã„å ´åˆã¯ 1-year ã‚’é¸æŠã—ãŸæ–¹ãŒè‰¯ã„</li></ul></li><li>1-year: 1 å¹´ã®äºˆç´„è³¼å…¥</li></ul></li><li><p>Payment Option: å‰æ‰•ã„ã®ã‚¿ã‚¤ãƒ—ã§ã™ã€‚</p><ul><li>All upfront: å…¨é¡å‰æ‰•ã„ï¼ˆæœ€ã‚‚ã‚³ã‚¹ãƒˆå‰Šæ¸›ç‡ãŒé«˜ã„ï¼‰</li><li>Partial upfront: ä¸€éƒ¨å‰æ‰•ã„</li><li>No upfront: å‰æ‰•ã„ã—ãªã„</li></ul></li><li><p>Based on the past ã®å€¤ã¯æ¨å¥¨å€¤ã‚’ç®—å‡ºã™ã‚‹ç‚ºã®éå»ã®é‹ç”¨æ—¥æ•°</p><ul><li>ç›´è¿‘ãŒå®‰å®šã—ã¦ã„ã‚‹ã®ã§ã‚ã‚Œã° 7 æ—¥é–“ ã‚’é¸æŠ</li><li>æ—¥å¸¸çš„ã« EC2, ECS ã‚¿ã‚¹ã‚¯ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ã‚‹å ´åˆã¯ 30 or 60 æ—¥é–“ã‚’é¸æŠ</li></ul></li></ul><p>ä»Šå¾Œ 1 å¹´ã‚’è¦‹è¶Šã—ã¦åˆ©ç”¨é‡ãŒå¤§ããæ¸›ã‚‹ã“ã¨ãŒãªã‘ã‚Œã°ã€éå»ã®åˆ©ç”¨é‡ã‹ã‚‰ AWS ãŒç®—å‡ºã—ãŸæ¨å¥¨å€¤ã‚’æ¡ç”¨ã™ã‚‹ã€ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</p><h3><span id="aws-savings-plans-è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹å ´åˆ">AWS Savings Plans è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹å ´åˆ</span></h3><p>è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹å ´åˆã¯ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚</p><ul><li><a href="https://us-east-1.console.aws.amazon.com/cost-management/home?region=us-east-1#/savings-plans/purchase">Savings Plans: è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹</a><br><img src="https://i.imgur.com/7KIypok.png"></li></ul><p>ä»Šå¾Œåˆ©ç”¨é‡ã«å¤‰åŒ–ãŒã‚ã‚Šãã†ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãªã©ã§åˆ©ç”¨æ–™ãŒå®‰å®šã—ãªã„å ´åˆã¯è‡ªå‰ã§è¨ˆç®—ã—è¨­å®šã—ã¾ã™ã€‚</p><h2><span id="cloudfront-security-bundle-ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡">CloudFront Security Bundle ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡</span></h2><p>ä»¥ä¸‹ãƒšãƒ¼ã‚¸ã§ç¢ºèªã§ãã¾ã™ã€‚</p><ul><li><p><a href="https://us-east-1.console.aws.amazon.com/cloudfront/v3/home#/savings-bundle/purchase">CloudFront: æ¨å¥¨å€¤</a><br><img src="https://i.imgur.com/2yW95Gh.png"></p></li><li><p>Term: 1-year ã®ã¿</p></li><li><p>Payment option: Monthly ã®ã¿</p></li><li><p>Auto renew: è‡ªå‹•æ›´æ–°</p><ul><li>è³¼å…¥ã«ã¯ç¨Ÿè­°ã‚’é€šã™å¿…è¦ãŒã‚ã‚‹ç­‰ã®ç†ç”±ã§ã‚ªãƒ•ã«ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ï¼ˆå€‹äººã®æ„Ÿæƒ³ï¼‰</li></ul></li><li><p>æœŸé™åˆ‡ã‚Œé€šçŸ¥æ©Ÿèƒ½ãŒãªã„ã®ã§é©å®œãƒã‚§ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</p></li></ul><p>AWS ã§éå»ã®åˆ©ç”¨é‡ã‚’å…ƒã«ã©ã®ç¨‹åº¦ã‚³ã‚¹ãƒˆå‰Šæ¸›ã§ãã‚‹ã‹è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><p>è‡ªå‹•æ›´æ–°ã®æœ‰åŠ¹ãƒ»ç„¡åŠ¹ã«ã¤ã„ã¦ã¯é©å®œåˆ¤å®šã—ã¦ãã ã•ã„ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%B9%B4%E9%96%93%E4%BA%88%E7%B4%84%E8%B3%BC%E5%85%A5%E3%81%BE%E3%81%A8%E3%82%81&quot;&gt;å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ri-%E6%9C%9F%E9%99%90%E5%88%87%E3%82%8C%E9%80%9A%E7%9F%A5-%E8%A8%AD%E5%AE%9A&quot;&gt;RI æœŸé™åˆ‡ã‚Œé€šçŸ¥ è¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#reserved-instance-%E8%B3%BC%E5%85%A5%E5%89%8D%E5%BE%8C%E3%81%AE%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D%E3%81%AE%E8%A8%88%E7%AE%97&quot;&gt;Reserved Instance è³¼å…¥å‰å¾Œã®ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ã®è¨ˆç®—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#savings-plans-%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D-%E8%A8%88%E7%AE%97&quot;&gt;Savings Plans ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡ è¨ˆç®—&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#aws-savings-plans-%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%80%A4%E6%8E%A8%E5%A5%A8%E5%80%A4%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88&quot;&gt;AWS Savings Plans ã‚³ãƒŸãƒƒãƒˆå€¤æ¨å¥¨å€¤ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#aws-savings-plans-%E8%87%AA%E5%89%8D%E3%81%A7%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%80%A4%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88&quot;&gt;AWS Savings Plans è‡ªå‰ã§ã‚³ãƒŸãƒƒãƒˆå€¤ã‚’è¨­å®šã™ã‚‹å ´åˆ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cloudfront-security-bundle-%E3%82%B3%E3%82%B9%E3%83%88%E5%89%8A%E6%B8%9B%E9%A1%8D&quot;&gt;CloudFront Security Bundle ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;AWS ãƒªã‚½ãƒ¼ã‚¹ã®å¹´é–“äºˆç´„è³¼å…¥ã«ã¤ã„ã¦å‚™å¿˜éŒ²ã§ã™ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚&quot;&gt;&lt;a href=&quot;#å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚&quot; class=&quot;headerlink&quot; title=&quot;å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚&quot;&gt;&lt;/a&gt;å¹´é–“äºˆç´„è³¼å…¥ã¾ã¨ã‚&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Reserved Instance&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¾è±¡:&lt;ul&gt;
&lt;li&gt;RDS&lt;/li&gt;
&lt;li&gt;ElastiCache&lt;/li&gt;
&lt;li&gt;RedShift&lt;/li&gt;
&lt;li&gt;OpenSearch&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥&lt;ul&gt;
&lt;li&gt;ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—&lt;/li&gt;
&lt;li&gt;å€‹æ•°&lt;/li&gt;
&lt;li&gt;å‰æ‰•ã„&lt;/li&gt;
&lt;li&gt;å¹´æ•°ï¼ˆå¼Šç¤¾ã¯ 1 å¹´æŒ‡å®šï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœŸé™åˆ‡ã‚Œé€šçŸ¥&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://us-east-1.console.aws.amazon.com/cost-management/home#/ri/alert&quot;&gt;RI ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†&lt;/a&gt; ã§è¨­å®š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pros:&lt;ul&gt;
&lt;li&gt;ã©ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦è³¼å…¥ã™ã‚‹ã‹ãŒæ±ºå®šã—ã‚„ã™ã„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Savings Plans&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¾è±¡: ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ï¼ˆEC2 å°‚ç”¨ã® Savings Plans ã‚‚ã‚ã‚‹ï¼‰&lt;ul&gt;
&lt;li&gt;EC2&lt;/li&gt;
&lt;li&gt;ECS&lt;/li&gt;
&lt;li&gt;Lambda&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥&lt;ul&gt;
&lt;li&gt;ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®åˆ©ç”¨é‡ã«å¯¾ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆå€¤&lt;/li&gt;
&lt;li&gt;å¹´æ•°&lt;/li&gt;
&lt;li&gt;å‰æ‰•ã„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœŸé™åˆ‡ã‚Œé€šçŸ¥&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://us-east-1.console.aws.amazon.com/cost-management/home#/savings-plans/overview/alert&quot;&gt;Savings Plans ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†&lt;/a&gt; ã§è¨­å®š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ã‚³ãƒŸãƒƒãƒˆå€¤&lt;ul&gt;
&lt;li&gt;éå»ãƒ»ä»Šå¾Œã®æ¨å®šåˆ©ç”¨é‡ã‹ã‚‰ç®—å‡ºã™ã‚‹ or AWS æ¨å¥¨å€¤ã‚’è¨­å®šã™ã‚‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pros:&lt;ul&gt;
&lt;li&gt;EC2 ã‹ã‚‰ ECS ã®ãƒªãƒ—ãƒ¬ã‚¤ã‚¹å¾Œã‚‚é©ç”¨ã•ã‚Œã‚‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Cons:&lt;ul&gt;
&lt;li&gt;ã©ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦è³¼å…¥ã—ãŸã‹ãŒåˆ†ã‹ã‚Šã¥ã‚‰ã„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CloudFront Security Bundle&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¾è±¡:&lt;ul&gt;
&lt;li&gt;CloudFront&lt;/li&gt;
&lt;li&gt;WAF&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»¥ä¸‹æŒ‡å®šã—è³¼å…¥&lt;ul&gt;
&lt;li&gt;CloudFront ã®åˆ©ç”¨é‡ã«å¯¾ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆå€¤&lt;/li&gt;
&lt;li&gt;å¹´æ•°&lt;/li&gt;
&lt;li&gt;å‰æ‰•ã„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœŸé™åˆ‡ã‚Œé€šçŸ¥&lt;ul&gt;
&lt;li&gt;ç¾çŠ¶ãªã„ (2023-12-07 æ™‚ç‚¹)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ã‚³ãƒŸãƒƒãƒˆå€¤&lt;ul&gt;
&lt;li&gt;éå»ãƒ»ä»Šå¾Œã®æ¨å®šåˆ©ç”¨é‡ã‹ã‚‰ç®—å‡ºã™ã‚‹ or AWS æ¨å¥¨å€¤ã‚’è¨­å®šã™ã‚‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>aws-cli ã§ AWS èµ·å‹•ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§å–å¾—ã™ã‚‹</title>
    <link href="https://kenzo0107.github.io/2023/11/30/2023-12-01-show-running-aws-resources/"/>
    <id>https://kenzo0107.github.io/2023/11/30/2023-12-01-show-running-aws-resources/</id>
    <published>2023-11-30T15:00:00.000Z</published>
    <updated>2023-11-30T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‚™å¿˜éŒ²ã§ã™ã€‚</p><p>è¤‡æ•° AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èµ·å‹•ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ä½œã‚ŠãŸã„æ™‚ã«ã‚ˆãåˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">profiles=(</span><br><span class="line">  &lt;profile names <span class="keyword">in</span> ~/.aws/credentials&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> profile <span class="keyword">in</span> <span class="variable">$&#123;profiles[@]&#125;</span>; <span class="keyword">do</span></span><br><span class="line">    awsume <span class="variable">$profile</span> --session-name <span class="string">&quot;kenzo.tanaka&quot;</span> --output-profile tmp</span><br><span class="line">    account_id=$(aws sts get-caller-identity --profile tmp --query <span class="string">&#x27;Account&#x27;</span> --output text)</span><br><span class="line"></span><br><span class="line">    aws ec2 --profile tmp describe-instances --filters <span class="string">&quot;Name=instance-state-name,Values=running&quot;</span> \</span><br><span class="line">        | jq -r <span class="string">&quot;.Reservations[].Instances[] | \&quot;<span class="variable">$profile</span>,<span class="variable">$account_id</span>,ec2,\&quot;+ .InstanceType +\&quot;,1,\&quot;+ (.Tags[]|select(.Key == \&quot;Name\&quot;).Value)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># aws rds describe-db-clusters ã ã¨ cluster ã‚’åˆ©ç”¨ã—ã¦ã„ãªã„å ´åˆã« instance æƒ…å ±ãŒå–å¾—ã§ããªã„</span></span><br><span class="line">    aws rds --profile tmp describe-db-instances \</span><br><span class="line">        | jq -r <span class="string">&quot;.DBInstances[] | select(.DBInstanceStatus==\&quot;available\&quot;) | \&quot;<span class="variable">$profile</span>,<span class="variable">$account_id</span>,\&quot;+ .Engine +\&quot;,\&quot;+ .DBInstanceClass +\&quot;,1,\&quot;+ .DBInstanceIdentifier&quot;</span></span><br><span class="line"></span><br><span class="line">    aws elasticache --profile tmp describe-cache-clusters \</span><br><span class="line">        | jq -r <span class="string">&quot;.CacheClusters[] | \&quot;<span class="variable">$profile</span>,<span class="variable">$account_id</span>,\&quot;+ .Engine +\&quot;,\&quot;+ .CacheNodeType +\&quot;,\&quot;+ (.NumCacheNodes|tostring) +\&quot;,\&quot;+ .CacheClusterId&quot;</span></span><br><span class="line"></span><br><span class="line">    aws redshift --profile tmp describe-clusters \</span><br><span class="line">        | jq -r <span class="string">&quot;.Clusters[] | select(.ClusterStatus==\&quot;available\&quot;) | \&quot;<span class="variable">$profile</span>,<span class="variable">$account_id</span>,redshift,\&quot;+ .NodeType +\&quot;,\&quot;+ (.NumberOfNodes|tostring) +\&quot;,\&quot;+ .ClusterIdentifier&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‚™å¿˜éŒ²ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;è¤‡æ•° AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èµ·å‹•ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ä½œã‚ŠãŸã„æ™‚ã«ã‚ˆãåˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;</summary>
      
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>AWS CLI ã§ EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åä¸€è¦§ã‚’å–å¾—</title>
    <link href="https://kenzo0107.github.io/2023/11/06/2023-11-07-describe-ec2-specified-tag-key-value/"/>
    <id>https://kenzo0107.github.io/2023/11/06/2023-11-07-describe-ec2-specified-tag-key-value/</id>
    <published>2023-11-06T15:00:00.000Z</published>
    <updated>2023-11-06T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>AWS CLI ã§ EC2 ã«è¨­å®šã•ã‚ŒãŸã‚¿ã‚°ã‹ã‚‰ç‰¹å®šã®ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã€ãã®å€¤ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚<br>ä»¥ä¸‹ã¯ Key = Name ã§ãã®å€¤ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚</p><p>EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åã®ä¸€è¦§ã‚’å–å¾—ã—ãŸã„æ„å›³ã§ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws ec2 describe-instances --query &#x27;Reservations[*].Instances[*].Tags[?Key == `Name`].Value&#x27; --output text</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;AWS CLI ã§ EC2 ã«è¨­å®šã•ã‚ŒãŸã‚¿ã‚°ã‹ã‚‰ç‰¹å®šã®ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã€ãã®å€¤ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚&lt;br&gt;ä»¥ä¸‹ã¯ Key = Name ã§ãã®å€¤ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
&lt;p&gt;EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åã®ä¸€è¦§ã‚’å–å¾—ã—ãŸã„æ„å›³ã§ã™ã€‚&lt;/p&gt;
&lt;figure class=&quot;h</summary>
      
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>python ã§ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—ã™ã‚‹</title>
    <link href="https://kenzo0107.github.io/2023/07/20/2023-07-21-python-load-file/"/>
    <id>https://kenzo0107.github.io/2023/07/20/2023-07-21-python-load-file/</id>
    <published>2023-07-20T15:00:00.000Z</published>
    <updated>2023-07-20T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E7%94%A8%E6%84%8F">ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨æ„</a></li><li><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%86%85%E5%AE%B9%E3%82%92%E5%8F%96%E5%BE%97">ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—</a></li><li><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE-1-%E8%A1%8C%E7%9B%AE%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97">ãƒ•ã‚¡ã‚¤ãƒ«ã® 1 è¡Œç›®ã®ã¿å–å¾—</a></li><li><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E8%A1%8C%E6%AF%8E%E3%81%AB%E5%8F%96%E5%BE%97">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡Œæ¯ã«å–å¾—</a></li><li><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97-yaml-%E3%81%A8%E3%81%97%E3%81%A6%E3%83%91%E3%83%BC%E3%82%B9%E3%81%99%E3%82%8B">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã— Yaml ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚‹</a></li></ul><!-- tocstop --></div></div><span id="more"></span><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>Python3 ã§ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•ã‚’ã¾ã¨ã‚ãŸå‚™å¿˜éŒ²ã§ã™ã€‚</p><h2><span id="ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨æ„">ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨æ„</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF&gt; sample.txt</span><br><span class="line">greeting:</span><br><span class="line">  ja: ã“ã‚“ã«ã¡ã¯</span><br><span class="line">  en: hello</span><br><span class="line"></span><br><span class="line">sports:</span><br><span class="line">  ja: ç›¸æ’²</span><br><span class="line">  en: ãƒã‚¹ã‚±ãƒƒãƒˆ</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h2><span id="ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—">ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sample.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">d = file.read()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">greeting:</span><br><span class="line">  ja: ã“ã‚“ã«ã¡ã¯</span><br><span class="line">  en: hello</span><br><span class="line"></span><br><span class="line">sports:</span><br><span class="line">  ja: ç›¸æ’²</span><br><span class="line">  en: ãƒã‚¹ã‚±ãƒƒãƒˆ</span><br></pre></td></tr></table></figure><h2><span id="ãƒ•ã‚¡ã‚¤ãƒ«ã®-1-è¡Œç›®ã®ã¿å–å¾—">ãƒ•ã‚¡ã‚¤ãƒ«ã® 1 è¡Œç›®ã®ã¿å–å¾—</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sample.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">d = file.readline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">greeting:</span><br></pre></td></tr></table></figure><h2><span id="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡Œæ¯ã«å–å¾—">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡Œæ¯ã«å–å¾—</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sample.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">d = file.readlines()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;greeting:\n&#x27;, &#x27;  ja: ã“ã‚“ã«ã¡ã¯\n&#x27;, &#x27;  en: hello\n&#x27;, &#x27;\n&#x27;, &#x27;sports:\n&#x27;, &#x27;  ja: ç›¸æ’²\n&#x27;, &#x27;  en: ãƒã‚¹ã‚±ãƒƒãƒˆ\n&#x27;]</span><br></pre></td></tr></table></figure><h2><span id="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—-yaml-ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚‹">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã— Yaml ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚‹</span></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyyaml</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sample.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    d = yaml.safe_load(file)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;---&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(d[<span class="string">&#x27;greeting&#x27;</span>][<span class="string">&#x27;ja&#x27;</span>])</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;greeting&#x27;: &#123;&#x27;ja&#x27;: &#x27;ã“ã‚“ã«ã¡ã¯&#x27;, &#x27;en&#x27;: &#x27;hello&#x27;&#125;, &#x27;sports&#x27;: &#123;&#x27;ja&#x27;: &#x27;ç›¸æ’²&#x27;, &#x27;en&#x27;: &#x27;ãƒã‚¹ã‚±ãƒƒãƒˆ&#x27;&#125;&#125;</span><br><span class="line">---</span><br><span class="line">ã“ã‚“ã«ã¡ã¯</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%82%E8%A6%81&quot;&gt;æ¦‚è¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E7%94%A8%E6%84%8F&quot;&gt;ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨æ„&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%86%85%E5%AE%B9%E3%82%92%E5%8F%96%E5%BE%97&quot;&gt;ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE-1-%E8%A1%8C%E7%9B%AE%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97&quot;&gt;ãƒ•ã‚¡ã‚¤ãƒ«ã® 1 è¡Œç›®ã®ã¿å–å¾—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E8%A1%8C%E6%AF%8E%E3%81%AB%E5%8F%96%E5%BE%97&quot;&gt;ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡Œæ¯ã«å–å¾—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97-yaml-%E3%81%A8%E3%81%97%E3%81%A6%E3%83%91%E3%83%BC%E3%82%B9%E3%81%99%E3%82%8B&quot;&gt;ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã— Yaml ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;</summary>
    
    
    
    <category term="Python" scheme="https://kenzo0107.github.io/categories/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>dependabot ãŒ pull request ã‚’ä½œæˆã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</title>
    <link href="https://kenzo0107.github.io/2023/07/13/2023-07-14-show-dependabot-pull-requests/"/>
    <id>https://kenzo0107.github.io/2023/07/13/2023-07-14-show-dependabot-pull-requests/</id>
    <published>2023-07-13T15:00:00.000Z</published>
    <updated>2023-07-13T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#%E6%89%8B%E9%A0%86">æ‰‹é †</a><ul><li><a href="#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88">ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</a></li></ul></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>terraform provider ã®æ›´æ–°ç­‰ã€ dependabot ã§ Pull Request ã®ä½œæˆã‚’ã—ã¦ã„ã‚‹ã¨<br>è‡ªåˆ†ãŒã‚¢ã‚µã‚¤ãƒ³ã•ã‚Œã¦ã„ãªã„ã®ã§æ°—ã¥ãã«ãã„ã§ã™ã€‚</p><p>ãã®ç‚ºã€å®šæœŸçš„ã«è¦‹ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ã§ã™ãŒã€ç®¡ç†ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªãŒå¤šã„ã¨å…¨ã¦è¦‹ã«è¡Œãã®ã¯æ‰‹é–“ãªã®ã§ã¾ã¨ã‚ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è¦‹ã‚Œã‚‹æ§˜ã«ã—ã¾ã™ã€‚</p><span id="more"></span><h2><span id="æ‰‹é †">æ‰‹é †</span></h2><p>äº‹å‰ã« gh ã‚³ãƒãƒ³ãƒ‰ã§èªè¨¼ã‚’æ¸ˆã¾ã›ã¦ãŠã</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gh auth login</span><br></pre></td></tr></table></figure><h3><span id="ã‚¹ã‚¯ãƒªãƒ—ãƒˆ">ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/zsh</span><br><span class="line"></span><br><span class="line">repos=(</span><br><span class="line">xxx-terraform</span><br><span class="line">yyy-terraform</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WORKDIR=$HOME/ghq/github.com/kenzo0107</span><br><span class="line"></span><br><span class="line">for repo in &quot;$&#123;repos[@]&#125;&quot;</span><br><span class="line">do</span><br><span class="line">    cd $WORKDIR/$repo</span><br><span class="line">    gh pr list -A app/dependabot</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>console å®Ÿè¡Œçµæœ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Showing 1 of 1 pull request <span class="keyword">in</span> kenzo0107/xxx-terraform that matches your search</span><br><span class="line"></span><br><span class="line"><span class="comment">#49  Bump hashicorp/aws from 5.2.0 to 5.6.2  dependabot/terraform/hashicorp/aws-5.6.2</span></span><br><span class="line"></span><br><span class="line">Showing 2 of 2 pull requests <span class="keyword">in</span> kenzo0107/yyy-terraform that match your search</span><br><span class="line"></span><br><span class="line"><span class="comment">#433  Bump hashicorp/aws from 5.1.0 to 5.7.0 in /envs/prd        dependabot/terraform/envs/prd/hashicorp/aws-5.7.0</span></span><br></pre></td></tr></table></figure><p>ã‚ã‚‹ç¨‹åº¦æ•°ãˆã‚‹ç¨‹åº¦ã ã£ãŸã®ã§å¯¾å¿œã™ã‚‹ terraform ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯é…åˆ—ã§æŒãŸã›ã¾ã—ãŸãŒã€<br>ãã“ã‚‚å‹•çš„ã«ã—ãŸã„å ´åˆã¯ terraform ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚ã‹ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã‚’æŠ½å‡ºã—ã¦ã‚‚ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%82%E8%A6%81&quot;&gt;æ¦‚è¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%89%8B%E9%A0%86&quot;&gt;æ‰‹é †&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88&quot;&gt;ã‚¹ã‚¯ãƒªãƒ—ãƒˆ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;h2 id=&quot;æ¦‚è¦&quot;&gt;&lt;a href=&quot;#æ¦‚è¦&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¦&quot;&gt;&lt;/a&gt;æ¦‚è¦&lt;/h2&gt;&lt;p&gt;terraform provider ã®æ›´æ–°ç­‰ã€ dependabot ã§ Pull Request ã®ä½œæˆã‚’ã—ã¦ã„ã‚‹ã¨&lt;br&gt;è‡ªåˆ†ãŒã‚¢ã‚µã‚¤ãƒ³ã•ã‚Œã¦ã„ãªã„ã®ã§æ°—ã¥ãã«ãã„ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;ãã®ç‚ºã€å®šæœŸçš„ã«è¦‹ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;p&gt;ã§ã™ãŒã€ç®¡ç†ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªãŒå¤šã„ã¨å…¨ã¦è¦‹ã«è¡Œãã®ã¯æ‰‹é–“ãªã®ã§ã¾ã¨ã‚ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è¦‹ã‚Œã‚‹æ§˜ã«ã—ã¾ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="GitHub" scheme="https://kenzo0107.github.io/categories/GitHub/"/>
    
    
  </entry>
  
  <entry>
    <title>asdf ã§ terraform è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†</title>
    <link href="https://kenzo0107.github.io/2023/07/07/2023-07-08-install-terraform-multi-versions-by-asdf/"/>
    <id>https://kenzo0107.github.io/2023/07/07/2023-07-08-install-terraform-multi-versions-by-asdf/</id>
    <published>2023-07-07T15:00:00.000Z</published>
    <updated>2023-07-07T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#asdf-%E6%8E%A8%E3%81%97%E3%81%9F%E7%90%86%E7%94%B1">asdf æ¨ã—ãŸç†ç”±</a></li><li><a href="#macos-%E3%81%AB-asdf-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">MacOS ã« asdf ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li><li><a href="#terraform-plugin-%E8%BF%BD%E5%8A%A0-%E8%A4%87%E6%95%B0%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">terraform plugin è¿½åŠ  &amp; è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li><li><a href="#%E7%89%B9%E5%AE%9A%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E3%81%BF%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B">ç‰¹å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹</a></li><li><a href="#tflint-tfsec-%E3%82%82%E5%90%8C%E6%A7%98%E3%81%AB-asdf-%E3%81%A7%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E7%AE%A1%E7%90%86%E3%81%A7%E3%81%8D%E3%82%8B">tflint, tfsec ã‚‚åŒæ§˜ã« asdf ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹</a></li></ul><!-- tocstop --></div></div><hr><p>terraform ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—é »åº¦ãŒé«˜ãã€<br>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³å·®åˆ†ãŒç”Ÿã˜ã‚‹ã®ã§<br>è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†ã§ãã‚‹ã¨é‹ç”¨ãŒã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚</p><span id="more"></span><h2><span id="asdf-æ¨ã—ãŸç†ç”±">asdf æ¨ã—ãŸç†ç”±</span></h2><p>terraform ã ã‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚‹ã®ã§ã‚ã‚Œã° <a href="https://github.com/tfutils/tfenv">tfenv</a> ãŒãƒ¡ã‚¸ãƒ£ãƒ¼ã§ã™ã€‚</p><p>ã§ã™ãŒã€ tflint, tfsec ã‚‚å°å…¥ã‚’æ¨å¥¨ã—ã¦ã„ã‚‹ã®ã§<br>ã‚ã‚‰ã‚†ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒåŒã˜æ–¹å¼ã§ã§ãã‚‹ã®ã§<br>asdf ã‚’æ¨ã—ã¦ã¾ã™ã€‚</p><h2><span id="macos-ã«-asdf-ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">MacOS ã« asdf ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span></h2><p>å‚è€ƒ: <a href="https://asdf-vm.com/guide/getting-started.html">https://asdf-vm.com/guide/getting-started.html</a></p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">brew install asdf</span></span><br><span class="line"></span><br><span class="line">// zsh ã®å ´åˆ</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> -e <span class="string">&quot;\n. \&quot;<span class="subst">$(brew --prefix asdf)</span>/libexec/asdf.sh\&quot;&quot;</span> &gt;&gt; ~/.zshrc</span></span><br><span class="line"></span><br><span class="line">// ãƒªãƒ­ãƒ¼ãƒ‰</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">exec</span> <span class="variable">$SHELL</span> -l</span></span><br></pre></td></tr></table></figure><h2><span id="terraform-plugin-è¿½åŠ -amp-è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">terraform plugin è¿½åŠ  &amp; è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf plugin add terraform</span></span><br><span class="line"></span><br><span class="line">// asdf çµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãª version ã®ãƒªã‚¹ãƒˆè¡¨ç¤º</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf list all terraform</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">1.5.0</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">// 1.5.0 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf install terraform 1.5.0</span></span><br></pre></td></tr></table></figure><h2><span id="ç‰¹å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹">ç‰¹å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> path/to/terraform-project</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf <span class="built_in">local</span> terraform 1.5.0</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">asdf reshim terraform</span></span><br></pre></td></tr></table></figure><p>.tool-versions ãŒç”Ÿæˆã•ã‚Œã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã•ã‚Œã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform 1.5.0</span><br></pre></td></tr></table></figure><p>.tool-versions ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã¨<br>ãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã§ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚Œã°ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹æ§˜ã«ãªã‚Šã¾ã™ã€‚</p><h2><span id="tflint-tfsec-ã‚‚åŒæ§˜ã«-asdf-ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹">tflint, tfsec ã‚‚åŒæ§˜ã« asdf ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ asdf plugin add tflint</span><br><span class="line">$ asdf plugin add tfsec</span><br></pre></td></tr></table></figure><p>ãƒ­ãƒ¼ã‚«ãƒ«ã§ tflint, tfsec ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ã‚ˆã‚‹æŒ™å‹•ã®å¤‰åŒ–ã‚’è©¦ã—ãŸã„å ´åˆã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#asdf-%E6%8E%A8%E3%81%97%E3%81%9F%E7%90%86%E7%94%B1&quot;&gt;asdf æ¨ã—ãŸç†ç”±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#macos-%E3%81%AB-asdf-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB&quot;&gt;MacOS ã« asdf ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#terraform-plugin-%E8%BF%BD%E5%8A%A0-%E8%A4%87%E6%95%B0%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB&quot;&gt;terraform plugin è¿½åŠ  &amp;amp; è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E7%89%B9%E5%AE%9A%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E3%81%BF%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B&quot;&gt;ç‰¹å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#tflint-tfsec-%E3%82%82%E5%90%8C%E6%A7%98%E3%81%AB-asdf-%E3%81%A7%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E7%AE%A1%E7%90%86%E3%81%A7%E3%81%8D%E3%82%8B&quot;&gt;tflint, tfsec ã‚‚åŒæ§˜ã« asdf ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;terraform ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—é »åº¦ãŒé«˜ãã€&lt;br&gt;ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³å·®åˆ†ãŒç”Ÿã˜ã‚‹ã®ã§&lt;br&gt;è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†ã§ãã‚‹ã¨é‹ç”¨ãŒã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã™ã‚‹ API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹</title>
    <link href="https://kenzo0107.github.io/2023/07/06/2023-07-07-aws-sam-enable-apigateway-accesslog/"/>
    <id>https://kenzo0107.github.io/2023/07/06/2023-07-07-aws-sam-enable-apigateway-accesslog/</id>
    <published>2023-07-06T15:00:00.000Z</published>
    <updated>2023-07-06T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a><ul><li><a href="#sam-templateyml-%E8%A8%AD%E5%AE%9A">SAM template.yml è¨­å®š</a></li></ul></li><li><a href="#%E7%B5%90%E8%AB%96">çµè«–</a></li><li><a href="#%E8%A9%A6%E3%81%97%E3%81%9F%E3%81%93%E3%81%A8-ng-%E9%9B%86">è©¦ã—ãŸã“ã¨ (NG é›†)</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã™ã‚‹ API Gateway ã«ã¤ã„ã¦<br>AWS Config rule: <code>api-gw-execution-logging-enabled</code> ã«å¯¾å¿œã™ã¹ãã€<br>ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–ã—ãŸéš›ã«ãƒãƒã£ãŸè©±ã§ã™ã€‚</p><p><code>Events.*.Type = Api</code> ã§ä½œæˆã—ãŸ API Gateway ã§ã¯ SAM ä¸Šã§ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°æœ‰åŠ¹åŒ–ã®è¨­å®šãŒã§ãã¾ã›ã‚“ã€‚</p><p>ã©ã®ã‚ˆã†ã«ã—ãŸã‚‰ API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°æœ‰åŠ¹åŒ–ã§ãã‚‹ã‹èª¿æŸ»ã—ã¾ã—ãŸã€‚</p><span id="more"></span><h3><span id="sam-templateyml-è¨­å®š">SAM template.yml è¨­å®š</span></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="attr">Function:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::Serverless::Function</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="string">...</span></span><br><span class="line">      <span class="attr">Events:</span></span><br><span class="line">        <span class="attr">Message:</span></span><br><span class="line">          <span class="attr">Type:</span> <span class="string">Api</span> <span class="comment"># ã“ã®è¨­å®šã§ç”Ÿæˆã—ãŸ API Gateway ã ã¨ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®æœ‰åŠ¹åŒ–ã®è¨­å®šãŒã§ããªã„</span></span><br><span class="line">          <span class="attr">Properties:</span></span><br><span class="line">            <span class="attr">Path:</span> <span class="string">/message</span></span><br><span class="line">            <span class="attr">Method:</span> <span class="string">post</span></span><br></pre></td></tr></table></figure><h2><span id="çµè«–">çµè«–</span></h2><p>2023-07-07 æ™‚ç‚¹ã€<br>API Gateway ã‚’æ–°ãŸã«ä½œæˆã—ãã¡ã‚‰ã«ä¹—ã‚Šæ›ãˆã‚‹ã—ã‹æ–¹æ³•ãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br>ãã®å ´åˆã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ãªã„é™ã‚Šã€API Gateway ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯å¤‰æ›´ã•ã‚Œã¾ã™ã€‚</p><p><code>Type: AWS::Serverless::Api</code> ç­‰ã€åˆ¥é€” API Gateway ä½œæˆã—ã€<code>RestApiId</code> ã§å‚ç…§ã™ã‚‹ã“ã¨ã§<br>ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚„ X-Ray Tracing ã®æœ‰åŠ¹åŒ–ãŒå¯èƒ½ã§ã—ãŸã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="attr">Lambda:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::Serverless::Function</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">Events:</span></span><br><span class="line">        <span class="attr">foo:</span></span><br><span class="line">          <span class="attr">Type:</span> <span class="string">Api</span></span><br><span class="line">          <span class="attr">Properties:</span></span><br><span class="line">            <span class="attr">RestApiId:</span> <span class="type">!Ref</span> <span class="string">ApiGateway</span></span><br><span class="line">            <span class="attr">Path:</span> <span class="string">/message</span></span><br><span class="line">            <span class="attr">Method:</span> <span class="string">post</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">ApiGateway:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::Serverless::Api</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">StageName:</span> <span class="string">Prod</span></span><br><span class="line">      <span class="attr">TracingEnabled:</span> <span class="literal">true</span> <span class="comment"># X-Ray Tracing æœ‰åŠ¹åŒ–</span></span><br><span class="line">      <span class="attr">AccessLogSetting:</span></span><br><span class="line">        <span class="attr">DestinationArn:</span> <span class="type">!GetAtt</span> <span class="string">ApiGatewayAccessLogGroup.Arn</span></span><br><span class="line">        <span class="attr">Format:</span> <span class="string">&#x27;&#123; &quot;requestId&quot;:&quot;$context.requestId&quot;, &quot;ip&quot;: &quot;$context.identity.sourceIp&quot;, &quot;caller&quot;:&quot;$context.identity.caller&quot;, &quot;user&quot;:&quot;$context.identity.user&quot;,&quot;requestTime&quot;:&quot;$context.requestTime&quot;, &quot;httpMethod&quot;:&quot;$context.httpMethod&quot;,&quot;resourcePath&quot;:&quot;$context.resourcePath&quot;, &quot;status&quot;:&quot;$context.status&quot;,&quot;protocol&quot;:&quot;$context.protocol&quot;, &quot;responseLength&quot;:&quot;$context.responseLength&quot; &#125;&#x27;</span></span><br><span class="line">      <span class="attr">MethodSettings:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">DataTraceEnabled:</span> <span class="literal">false</span> <span class="comment"># true ã«ã—å…¨ã¦ã®ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹ç‚ºã€ false ã§ error ã®ã¿ã«çµã‚‹</span></span><br><span class="line">          <span class="attr">LoggingLevel:</span> <span class="string">ERROR</span> <span class="comment"># error ã®ã¿ãƒ­ã‚°ã«è¨˜éŒ²</span></span><br><span class="line">          <span class="attr">ResourcePath:</span> <span class="string">&#x27;/*&#x27;</span> <span class="comment"># å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãƒ‘ã‚¹å¯¾è±¡</span></span><br><span class="line">          <span class="attr">HttpMethod:</span> <span class="string">&#x27;*&#x27;</span> <span class="comment"># å…¨ã¦ã® HTTP Method å¯¾è±¡</span></span><br></pre></td></tr></table></figure><p>ã‚‚ã—ãƒ‰ãƒ¡ã‚¤ãƒ³å¤‰æ›´ã‚’è¨±å®¹ã—ãªã„å ´åˆã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã€‚<br>sam deploy å¾Œã‚‚ä¸Šè¨˜å‡¦ç†ã«ã¤ã„ã¦å¤‰æ›´ãŒãªã„ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿ã§ã™ã€‚</p><h2><span id="è©¦ã—ãŸã“ã¨-ng-é›†">è©¦ã—ãŸã“ã¨ (NG é›†)</span></h2><ul><li><p>AWS::Serverless::ApiÂ  ã§å®šç¾©ã— Â APIÂ GatewayÂ  ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResourceTypes [AWS::Serverless::Api] are not supported for Import</span><br></pre></td></tr></table></figure><p>å‚è€ƒ:Â <a href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/resource-import-supported-resources.html">ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŠã‚ˆã³ãƒ‰ãƒªãƒ•ãƒˆæ¤œå‡ºã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹</a></p></li><li><p>AWS::ApiGateway::RestApiÂ  ã§å®šç¾©ã— Â APIÂ GatewayÂ  ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have modified resources [ServerlessRestApi, ServerlessRestApiDeployment2ababeb14f, ServerlessRestApiProdStage, FunctionMessagePermissionProd] in your template that are not being imported. Update, create or delete operations cannot be executed during import operations.</span><br></pre></td></tr></table></figure><p>ä»–ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šãŒä¸è¶³ã—ã¦ã„ã‚‹ã‚ˆã†ã ã€‚</p></li><li><p>AWS::ApiGateway::Stage ã®ã¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcd1a2b3c|Prod already exists in stack arn:aws:cloudformation:ap-northeast-1:123456789012:stack/Bot-Stack/e50458c0-1234-12ab-a12f-123a4b5c6d7e</span><br></pre></td></tr></table></figure></li></ul><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%82%E8%A6%81&quot;&gt;æ¦‚è¦&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#sam-templateyml-%E8%A8%AD%E5%AE%9A&quot;&gt;SAM template.yml è¨­å®š&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E7%B5%90%E8%AB%96&quot;&gt;çµè«–&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E8%A9%A6%E3%81%97%E3%81%9F%E3%81%93%E3%81%A8-ng-%E9%9B%86&quot;&gt;è©¦ã—ãŸã“ã¨ (NG é›†)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;h2 id=&quot;æ¦‚è¦&quot;&gt;&lt;a href=&quot;#æ¦‚è¦&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¦&quot;&gt;&lt;/a&gt;æ¦‚è¦&lt;/h2&gt;&lt;p&gt;SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã™ã‚‹ API Gateway ã«ã¤ã„ã¦&lt;br&gt;AWS Config rule: &lt;code&gt;api-gw-execution-logging-enabled&lt;/code&gt; ã«å¯¾å¿œã™ã¹ãã€&lt;br&gt;ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–ã—ãŸéš›ã«ãƒãƒã£ãŸè©±ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Events.*.Type = Api&lt;/code&gt; ã§ä½œæˆã—ãŸ API Gateway ã§ã¯ SAM ä¸Šã§ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°æœ‰åŠ¹åŒ–ã®è¨­å®šãŒã§ãã¾ã›ã‚“ã€‚&lt;/p&gt;
&lt;p&gt;ã©ã®ã‚ˆã†ã«ã—ãŸã‚‰ API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°æœ‰åŠ¹åŒ–ã§ãã‚‹ã‹èª¿æŸ»ã—ã¾ã—ãŸã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>SAM ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ‰‹é † - IAM Role ç·¨ -</title>
    <link href="https://kenzo0107.github.io/2023/06/19/2023-06-20-aws-sam-import-iam-role/"/>
    <id>https://kenzo0107.github.io/2023/06/19/2023-06-20-aws-sam-import-iam-role/</id>
    <published>2023-06-19T15:00:00.000Z</published>
    <updated>2023-06-19T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%89%8B%E9%A0%86">æ‰‹é †</a><ul><li><a href="#cloudformation-%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E5%8F%96%E5%BE%97%E3%81%97-templateyml-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%BF%BD%E8%A8%98">CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜</a></li><li><a href="#importjson-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%A8%98%E8%BC%89">import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰</a></li></ul></li></ul><!-- tocstop --></div></div><hr><a href="https://kenzo0107.github.io/2023/06/06/2023-06-07-aws-sam-import-resource" class="link-preview" target="_blank"><div class="link-area"><div class="og-image"><img src="https://i.imgur.com/nieeIsl.png"></div><div class="descriptions"><div class="og-title">SAM ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ‰‹é † - CloudWatch Logs ç·¨ -</div><div class="og-description">ToC     æ‰‹é † CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜ import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰ Change sets ã‚’ä½œæˆã™ã‚‹ change set ã‚’å®Ÿè¡Œ (ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ) ã‚¤ãƒ³â€¦</div></div></div></a><p>ä»¥å‰ã¯ CloudWatch LogGroup ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸãŒ<br>ä»Šå›ã¯ IAM Role ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®è¨­å®šä¾‹ã§ã™ã€‚</p><p>åŸºæœ¬æ‰‹é †ã¯ CloudWatch LogGroup ã¨åŒæ§˜ã§ã™ãŒã€<br>ç•°ãªã‚‹éƒ¨åˆ†ã ã‘è¨˜è¼‰ã—ã¾ã™ã€‚</p><h2><span id="æ‰‹é †">æ‰‹é †</span></h2><h3><span id="cloudformation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã—-templateyml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜">CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜</span></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">CWLogRole:</span></span><br><span class="line">    <span class="attr">DeletionPolicy:</span> <span class="string">Retain</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::IAM::Role</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">RoleName:</span> <span class="string">xxx-Bot-Stack</span></span><br><span class="line">      <span class="attr">AssumeRolePolicyDocument:</span></span><br><span class="line">        <span class="attr">Version:</span> <span class="number">2012-10-17</span></span><br><span class="line">        <span class="attr">Statement:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">Effect:</span> <span class="string">Allow</span></span><br><span class="line">            <span class="attr">Principal:</span></span><br><span class="line">              <span class="attr">Service:</span> <span class="string">apigateway.amazonaws.com</span></span><br><span class="line">            <span class="attr">Action:</span> <span class="string">sts:AssumeRole</span></span><br><span class="line">      <span class="attr">Description:</span> <span class="string">Allows</span> <span class="string">API</span> <span class="string">Gateway</span> <span class="string">to</span> <span class="string">push</span> <span class="string">logs</span> <span class="string">to</span> <span class="string">CloudWatch</span> <span class="string">Logs.</span></span><br><span class="line">      <span class="attr">ManagedPolicyArns:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">arn:aws:iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs</span></span><br></pre></td></tr></table></figure><p>API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã¸ãƒ­ã‚°ã‚’é…ä¿¡ã™ã‚‹ IAM Role ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚</p><span id="more"></span><h3><span id="importjson-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰">import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;ResourceType&quot;: &quot;AWS::IAM::Role&quot;,</span><br><span class="line">        &quot;LogicalResourceId&quot;: &quot;CWLogRole&quot;,</span><br><span class="line">        &quot;ResourceIdentifier&quot;: &#123;</span><br><span class="line">            &quot;RoleName&quot;:&quot;xxx-Bot-Stack&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯¾è±¡ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ ã—<br>å…ˆç¨‹ã® template.yml ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">aws cloudformation create-change-set \</span></span><br><span class="line"><span class="language-bash">    --stack-name xxx-Bot-Stack \</span></span><br><span class="line"><span class="language-bash">    --change-set-name import-cwlogs-role \</span></span><br><span class="line"><span class="language-bash">    --resources-to-import file://import.json \</span></span><br><span class="line"><span class="language-bash">    --change-set-type IMPORT \</span></span><br><span class="line"><span class="language-bash">    --template-body file://template.yml \</span></span><br><span class="line"><span class="language-bash">    --capabilities CAPABILITY_NAMED_IAM</span></span><br></pre></td></tr></table></figure><p>capabilities ã¯ CAPABILITY_NAMED_IAM ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br>IAM Role ãƒªã‚½ãƒ¼ã‚¹ã«ç‹¬è‡ªã®å‘½åã‚’ã—ãŸã„å ´åˆã«åˆ©ç”¨ã—ã¾ã™ã€‚</p><p>å‚è€ƒ: <a href="https://docs.aws.amazon.com/ja_jp/serverlessrepo/latest/devguide/acknowledging-application-capabilities.html">https://docs.aws.amazon.com/ja_jp/serverlessrepo/latest/devguide/acknowledging-application-capabilities.html</a></p><p>ã‚ã¨ã¯åŒæ§˜ã«æ‰‹é †ã‚’é€²ã‚ã¾ã™ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%89%8B%E9%A0%86&quot;&gt;æ‰‹é †&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#cloudformation-%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E5%8F%96%E5%BE%97%E3%81%97-templateyml-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%BF%BD%E8%A8%98&quot;&gt;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#importjson-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%A8%98%E8%BC%89&quot;&gt;import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;a href=&quot;https://kenzo0107.github.io/2023/06/06/2023-06-07-aws-sam-import-resource&quot; class=&quot;link-preview&quot; target=&quot;_blank&quot;&gt;&lt;div class=&quot;link-area&quot;&gt;&lt;div class=&quot;og-image&quot;&gt;&lt;img src=&quot;https://i.imgur.com/nieeIsl.png&quot;&gt;&lt;/img&gt;&lt;/div&gt;&lt;div class=&quot;descriptions&quot;&gt;&lt;div class=&quot;og-title&quot;&gt;SAM ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ‰‹é † - CloudWatch Logs ç·¨ -&lt;/div&gt;&lt;div class=&quot;og-description&quot;&gt;ToC     æ‰‹é † CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜ import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰ Change sets ã‚’ä½œæˆã™ã‚‹ change set ã‚’å®Ÿè¡Œ (ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ) ã‚¤ãƒ³â€¦&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;

&lt;p&gt;ä»¥å‰ã¯ CloudWatch LogGroup ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸãŒ&lt;br&gt;ä»Šå›ã¯ IAM Role ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®è¨­å®šä¾‹ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;åŸºæœ¬æ‰‹é †ã¯ CloudWatch LogGroup ã¨åŒæ§˜ã§ã™ãŒã€&lt;br&gt;ç•°ãªã‚‹éƒ¨åˆ†ã ã‘è¨˜è¼‰ã—ã¾ã™ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ‰‹é †&quot;&gt;&lt;a href=&quot;#æ‰‹é †&quot; class=&quot;headerlink&quot; title=&quot;æ‰‹é †&quot;&gt;&lt;/a&gt;æ‰‹é †&lt;/h2&gt;&lt;h3 id=&quot;CloudFormation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã—-template-yml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot;&gt;&lt;a href=&quot;#CloudFormation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã—-template-yml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot; class=&quot;headerlink&quot; title=&quot;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot;&gt;&lt;/a&gt;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—ã— template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&lt;/h3&gt;&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;Resources:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;CWLogRole:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;DeletionPolicy:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Retain&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;Type:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;AWS::IAM::Role&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;Properties:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;RoleName:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;xxx-Bot-Stack&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;AssumeRolePolicyDocument:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;Version:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2012-10-17&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;Statement:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;Effect:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Allow&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attr&quot;&gt;Principal:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;attr&quot;&gt;Service:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;apigateway.amazonaws.com&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attr&quot;&gt;Action:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sts:AssumeRole&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;Description:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Allows&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;API&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Gateway&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;logs&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;CloudWatch&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Logs.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;ManagedPolicyArns:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;arn:aws:iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã¸ãƒ­ã‚°ã‚’é…ä¿¡ã™ã‚‹ IAM Role ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>SAM ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ‰‹é † - CloudWatch Logs ç·¨ -</title>
    <link href="https://kenzo0107.github.io/2023/06/06/2023-06-07-aws-sam-import-resource/"/>
    <id>https://kenzo0107.github.io/2023/06/06/2023-06-07-aws-sam-import-resource/</id>
    <published>2023-06-06T15:00:00.000Z</published>
    <updated>2023-06-06T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%89%8B%E9%A0%86">æ‰‹é †</a><ul><li><a href="#cloudformation-%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E5%8F%96%E5%BE%97">CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—</a></li><li><a href="#templateyml-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%BF%BD%E8%A8%98">template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜</a></li><li><a href="#importjson-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%A8%98%E8%BC%89">import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰</a></li><li><a href="#change-sets-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">Change sets ã‚’ä½œæˆã™ã‚‹</a></li><li><a href="#change-set-%E3%82%92%E5%AE%9F%E8%A1%8C-%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E5%AE%9F%E8%A1%8C">change set ã‚’å®Ÿè¡Œ (ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ)</a><ul><li><a href="#%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AB%E3%82%BF%E3%82%B0%E3%81%8C%E8%BF%BD%E5%8A%A0%E3%81%95%E3%82%8C%E3%82%8B">ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã«ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã‚‹</a></li></ul></li><li><a href="#sam-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88-templateyml-%E6%9B%B4%E6%96%B0">SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ template.yml æ›´æ–°</a></li></ul></li><li><a href="#%E3%81%8A%E3%81%BE%E3%81%91-sam-%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E7%AE%A1%E7%90%86%E9%99%A4%E5%A4%96%E3%81%99%E3%82%8B-import-%E3%81%AE%E9%80%86">ãŠã¾ã‘: SAM ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†é™¤å¤–ã™ã‚‹ (import ã®é€†)</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ‰‹é †">æ‰‹é †</span></h2><h3><span id="cloudformation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—">CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—</span></h3><p><img src="https://i.imgur.com/nieeIsl.png"></p><p>æ—¢ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ã® SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ CloudFormation ã« Stack ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚<br>ãã® <code>Template</code> ã‚¿ã‚°ã§ template ã®å†…å®¹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ <code>template.yml</code> ã§ä¿å­˜ã—ã¾ã—ã‚‡ã†ã€‚<br>ä¿å­˜å…ˆã¯ã©ã“ã§ã‚‚è‰¯ã„ã§ã™ã€‚</p><h3><span id="templateyml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜">template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜</span></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜</span></span><br><span class="line">  <span class="comment"># API Gateway ã® ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—</span></span><br><span class="line">  <span class="attr">ApiGatewayAccessLogGroup:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::Logs::LogGroup</span></span><br><span class="line">    <span class="comment"># <span class="doctag">NOTE:</span> ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã›ãšã€Stack ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ç‚ºã®è¨­å®š</span></span><br><span class="line">    <span class="comment"># see: https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html</span></span><br><span class="line">    <span class="attr">DeletionPolicy:</span> <span class="string">Retain</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">LogGroupName:</span> <span class="string">/aws/apigateway/xxx-Bot-Stack</span></span><br></pre></td></tr></table></figure><p>ä»Šå›ã¯ API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚<br><code>DeletionPolicy: Retain</code> ã¨ã—ã¦ã„ã‚‹ã®ã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã›ãšã€Stack ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ç‚ºã§ã™ã€‚</p><span id="more"></span><h3><span id="importjson-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰">import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;ResourceType&quot;: &quot;AWS::Logs::LogGroup&quot;,</span><br><span class="line">        &quot;LogicalResourceId&quot;: &quot;ApiGatewayAccessLogGroup&quot;,</span><br><span class="line">        &quot;ResourceIdentifier&quot;: &#123;</span><br><span class="line">            &quot;LogGroupName&quot;:&quot;/aws/apigateway/xxx-Bot-Stack&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯¾è±¡ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ ã—<br>å…ˆç¨‹ã® template.yml ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ã¾ã™ã€‚</p><h3><span id="change-sets-ã‚’ä½œæˆã™ã‚‹">Change sets ã‚’ä½œæˆã™ã‚‹</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ aws cloudformation create-change-set \</span><br><span class="line">    --stack-name xxx-Bot-Stack \</span><br><span class="line">    --change-set-name import-apigateway-accesslog-loggroup \</span><br><span class="line">    --resources-to-import file://import.json \</span><br><span class="line">    --change-set-type IMPORT \</span><br><span class="line">    --template-body file://template.yml \</span><br><span class="line">    --capabilities CAPABILITY_IAM</span><br></pre></td></tr></table></figure><p>â€» ã“ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã—ãŸæ™‚ç‚¹ã§ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚</p><p>ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ã« <code>Change sets</code> ã«ã‚»ãƒƒãƒˆãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚Œã° OK ã§ã™ã€‚</p><p><img src="https://i.imgur.com/5JVMX2A.png"></p><p>Change sets ã® Name ãŒãƒªãƒ³ã‚¯ã«ãªã£ã¦ã„ã‚‹ã®ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</p><h3><span id="change-set-ã‚’å®Ÿè¡Œ-ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ">change set ã‚’å®Ÿè¡Œ (ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ)</span></h3><p><img src="https://i.imgur.com/EbPH7XZ.png"></p><p>å³ä¸Šã® <code>Execute change set</code> ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã— Stack ã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p><p>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹= <code>IMPORT_COMPLETE</code> ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†ã¨ãªã‚Šã¾ã™ã€‚<br><img src="https://i.imgur.com/e3pu5ih.png"></p><h4><span id="ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã«ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã‚‹">ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã«ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã‚‹</span></h4><p><img src="https://i.imgur.com/3BQeLUv.png"></p><p>Stack ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã« Stack ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹æ—¨ã®ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p><h3><span id="sam-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ-templateyml-æ›´æ–°">SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ template.yml æ›´æ–°</span></h3><p>ã‚¤ãƒ³ãƒãƒ¼ãƒˆç”¨ã«ç”¨æ„ã—ãŸ template.yml ã¨ã¯ç•°ãªã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«å‚ç…§ã™ã‚‹ yml ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚<br>ã“ã“ã§ã¯ <code>DeletionPolicy: Retain</code> ã¯ä¸è¦ã§ã™ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line">  <span class="comment"># è¿½è¨˜</span></span><br><span class="line">  <span class="attr">ApiGatewayAccessLogGroup:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::Logs::LogGroup</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">LogGroupName:</span> <span class="string">/aws/apigateway/xxx-Bot-Stack</span></span><br><span class="line">      <span class="attr">RetentionInDays:</span> <span class="number">14</span></span><br></pre></td></tr></table></figure><p>SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ <code>DeletionPolicy: Retain</code> ã®å·®åˆ†ãŒã‚ã‚‹ç‚ºã€å¤‰æ›´ã®å·®åˆ†ãŒå‡ºã¾ã™ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">$ sam deploy -t <span class="variable">$&#123;TEMPLATE_FILE&#125;</span> \</span><br><span class="line">--stack-name xxx-Bot-Stack \</span><br><span class="line">--s3-prefix xxx-Bot-Stack \</span><br><span class="line">--s3-bucket yyy \</span><br><span class="line">--capabilities CAPABILITY_IAM \</span><br><span class="line">--region ap-northeast-1 \</span><br><span class="line">--no-fail-on-empty-changeset \</span><br><span class="line">--no-progressbar</span><br><span class="line"></span><br><span class="line">Initiating deployment</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">File with same data already exists at xxx-Bot-Stack/nnn.template, skipping upload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Waiting <span class="keyword">for</span> changeset to be created..</span><br><span class="line"></span><br><span class="line">CloudFormation stack changeset</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">Operation                        LogicalResourceId                ResourceType                     Replacement</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">* Modify                         ApiGatewayAccessLogGroup         AWS::Logs::LogGroup              False</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Changeset created successfully. arn:aws:cloudformation:ap-northeast-1:123456789012:changeSet/samcli-deploy123/zzz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2023-06-07 12:22:16 - Waiting <span class="keyword">for</span> stack create/update to complete</span><br><span class="line"></span><br><span class="line">CloudFormation events from stack operations (refresh every 5.0 seconds)</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">ResourceStatus                   ResourceType                     LogicalResourceId                ResourceStatusReason</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">UPDATE_COMPLETE                  AWS::Logs::LogGroup              ApiGatewayAccessLogGroup         -</span><br><span class="line">UPDATE_COMPLETE_CLEANUP_IN_PRO   AWS::CloudFormation::Stack       xxx-Bot-Stack              -</span><br><span class="line">GRESS</span><br><span class="line">UPDATE_COMPLETE                  AWS::CloudFormation::Stack       xxx-Bot-Stack              -</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">CloudFormation outputs from deployed stack</span><br><span class="line">------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">Outputs</span><br><span class="line">------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">Key                 SlackMessageApi</span><br><span class="line">Description         -</span><br><span class="line">Value               https://yyy.execute-api.ap-northeast-1.amazonaws.com/Prod/message/</span><br><span class="line">------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Successfully created/updated stack - xxx-Bot-Stack <span class="keyword">in</span> ap-northeast-1</span><br></pre></td></tr></table></figure><p>ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€å†åº¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã‚ˆã†ã¨ã™ã‚‹ã¨å·®åˆ†ãŒãªããªã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ sam deploy -t <span class="variable">$&#123;TEMPLATE_FILE&#125;</span> \</span><br><span class="line">--stack-name xxx-Bot-Stack \</span><br><span class="line">--s3-prefix xxx-Bot-Stack \</span><br><span class="line">--s3-bucket yyy \</span><br><span class="line">--capabilities CAPABILITY_IAM \</span><br><span class="line">--region ap-northeast-1 \</span><br><span class="line">--no-fail-on-empty-changeset \</span><br><span class="line">--no-progressbar</span><br><span class="line"></span><br><span class="line">File with same data already exists at xxx-Bot-Stack/7d47ca74f4c587c742cd0df1f7252ecd.template, skipping upload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Waiting <span class="keyword">for</span> changeset to be created..</span><br><span class="line"></span><br><span class="line">No changes to deploy. Stack xxx-Bot-Stack is up to <span class="built_in">date</span></span><br></pre></td></tr></table></figure><p>ã“ã‚Œã«ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå•é¡Œãªãã§ããŸã“ã¨ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚</p><h2><span id="ãŠã¾ã‘-sam-ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†é™¤å¤–ã™ã‚‹-import-ã®é€†">ãŠã¾ã‘: SAM ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†é™¤å¤–ã™ã‚‹ (import ã®é€†)</span></h2><p>Stack &gt; Template ã‚’ template.yml ã§ä¿å­˜ã—ã€å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p><p>ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã‚’é™¤å¤–ã™ã‚‹ Change set ã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aws cloudformation create-change-set \</span><br><span class="line">    --stack-name xxx-Bot-Stack \</span><br><span class="line">    --change-set-name remove-apigateway-loggroup \</span><br><span class="line">    --change-set-type UPDATE \</span><br><span class="line">    --template-body file://template.yml \</span><br><span class="line">    --capabilities CAPABILITY_IAM</span><br></pre></td></tr></table></figure><p>ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§ Execute change set ã‚’å®Ÿè¡Œã—å‰Šé™¤ã§ãã¾ã™ã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;ToC&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%89%8B%E9%A0%86&quot;&gt;æ‰‹é †&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#cloudformation-%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E5%8F%96%E5%BE%97&quot;&gt;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#templateyml-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%BF%BD%E8%A8%98&quot;&gt;template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#importjson-%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%81%84%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E8%A8%98%E8%BC%89&quot;&gt;import.json ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨˜è¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#change-sets-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B&quot;&gt;Change sets ã‚’ä½œæˆã™ã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#change-set-%E3%82%92%E5%AE%9F%E8%A1%8C-%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E5%AE%9F%E8%A1%8C&quot;&gt;change set ã‚’å®Ÿè¡Œ (ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ)&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%97%E3%81%9F%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AB%E3%82%BF%E3%82%B0%E3%81%8C%E8%BF%BD%E5%8A%A0%E3%81%95%E3%82%8C%E3%82%8B&quot;&gt;ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã«ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã‚‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sam-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88-templateyml-%E6%9B%B4%E6%96%B0&quot;&gt;SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ template.yml æ›´æ–°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E3%81%8A%E3%81%BE%E3%81%91-sam-%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E7%AE%A1%E7%90%86%E9%99%A4%E5%A4%96%E3%81%99%E3%82%8B-import-%E3%81%AE%E9%80%86&quot;&gt;ãŠã¾ã‘: SAM ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†é™¤å¤–ã™ã‚‹ (import ã®é€†)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;hr&gt;
&lt;h2 id=&quot;æ‰‹é †&quot;&gt;&lt;a href=&quot;#æ‰‹é †&quot; class=&quot;headerlink&quot; title=&quot;æ‰‹é †&quot;&gt;&lt;/a&gt;æ‰‹é †&lt;/h2&gt;&lt;h3 id=&quot;CloudFormation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—&quot;&gt;&lt;a href=&quot;#CloudFormation-ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—&quot; class=&quot;headerlink&quot; title=&quot;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—&quot;&gt;&lt;/a&gt;CloudFormation ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/nieeIsl.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ—¢ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ã® SAM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ CloudFormation ã« Stack ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;br&gt;ãã® &lt;code&gt;Template&lt;/code&gt; ã‚¿ã‚°ã§ template ã®å†…å®¹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ &lt;code&gt;template.yml&lt;/code&gt; ã§ä¿å­˜ã—ã¾ã—ã‚‡ã†ã€‚&lt;br&gt;ä¿å­˜å…ˆã¯ã©ã“ã§ã‚‚è‰¯ã„ã§ã™ã€‚&lt;/p&gt;
&lt;h3 id=&quot;template-yml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot;&gt;&lt;a href=&quot;#template-yml-ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot; class=&quot;headerlink&quot; title=&quot;template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&quot;&gt;&lt;/a&gt;template.yml ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&lt;/h3&gt;&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;Resources:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½è¨˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# API Gateway ã® ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;ApiGatewayAccessLogGroup:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;Type:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;AWS::Logs::LogGroup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# &lt;span class=&quot;doctag&quot;&gt;NOTE:&lt;/span&gt; ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã›ãšã€Stack ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ç‚ºã®è¨­å®š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# see: https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;DeletionPolicy:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Retain&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;Properties:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;LogGroupName:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;/aws/apigateway/xxx-Bot-Stack&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä»Šå›ã¯ API Gateway ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç®¡ç†ç”¨ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚&lt;br&gt;&lt;code&gt;DeletionPolicy: Retain&lt;/code&gt; ã¨ã—ã¦ã„ã‚‹ã®ã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã›ãšã€Stack ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ç‚ºã§ã™ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>fix: Could not install packages due to an EnvironmentError: [Errno 28] No space left on device</title>
    <link href="https://kenzo0107.github.io/2023/05/31/2023-06-01-fix-no-space-left-on-device-when-pip-install/"/>
    <id>https://kenzo0107.github.io/2023/05/31/2023-06-01-fix-no-space-left-on-device-when-pip-install/</id>
    <published>2023-05-31T15:00:00.000Z</published>
    <updated>2023-05-31T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>RPi 4B ã§ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ã§è©°ã¾ã£ãŸæ™‚ã®å‚™å¿˜éŒ²ã§ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install xxx</span><br><span class="line"></span><br><span class="line">Could not install packages due to an EnvironmentError: [Errno 28] No space left on device</span><br></pre></td></tr></table></figure><p>ä¸€æ™‚çš„ã« tmp ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å†åº¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã§å›é¿ã—ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir $HOME/tmp</span><br><span class="line">$ export TMPDIR=$HOME/tmp</span><br><span class="line"></span><br><span class="line">$ pip3 install xxx</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§ã†ã¾ãã„ãã¾ã—ãŸ â™ª</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;RPi 4B ã§ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ã§è©°ã¾ã£ãŸæ™‚ã®å‚™å¿˜éŒ²ã§ã™ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;spa</summary>
      
    
    
    
    <category term="RaspberryPI" scheme="https://kenzo0107.github.io/categories/RaspberryPI/"/>
    
    
  </entry>
  
  <entry>
    <title>AWS Savings Plans Coverage API å®Ÿè¡Œæ™‚ã« DataUnavailableException ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹</title>
    <link href="https://kenzo0107.github.io/2023/05/31/2023-06-01-get-savings-plans-coverage-data-unavailable-exception/"/>
    <id>https://kenzo0107.github.io/2023/05/31/2023-06-01-get-savings-plans-coverage-data-unavailable-exception/</id>
    <published>2023-05-31T15:00:00.000Z</published>
    <updated>2023-05-31T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E3%81%AE%E5%9B%9E%E7%AD%94">ã‚µãƒãƒ¼ãƒˆã®å›ç­”</a></li><li><a href="#cost-explorer-%E3%81%A7%E7%A2%BA%E8%AA%8D">Cost Explorer ã§ç¢ºèª</a></li><li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">ã¾ã¨ã‚</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>AWS Savings Plans Coverage API å®Ÿè¡Œæ™‚ã« DataUnavailableException ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">aws ce get-savings-plans-coverage --time-period Start=2023-05-31,End=2023-06-01 --group-by Type=DIMENSION,Key=INSTANCE_TYPE_FAMILY Type=DIMENSION,Key=REGION Type=DIMENSION,Key=SERVICE</span></span><br><span class="line"></span><br><span class="line">An error occurred (DataUnavailableException) when calling the GetSavingsPlansCoverage operation:</span><br></pre></td></tr></table></figure><p>ç™ºç”Ÿã™ã‚‹æ¡ä»¶ã‚’ AWS ã‚µãƒãƒ¼ãƒˆã«ç¢ºèªã—ã¾ã—ãŸã€‚</p><h2><span id="ã‚µãƒãƒ¼ãƒˆã®å›ç­”">ã‚µãƒãƒ¼ãƒˆã®å›ç­”</span></h2><p>ã€Œå¯¾è±¡æœŸé–“ã«ã¤ã„ã¦ Savings Plans é©ç”¨å¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã€ä¸Šè¨˜ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã€<br>ã¨ã®ã“ã¨ã€‚</p><h2><span id="cost-explorer-ã§ç¢ºèª">Cost Explorer ã§ç¢ºèª</span></h2><p>Cost Explorer ã§ Savings Plans &gt; Coverage report ã«ã‚‚ä»¥ä¸‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã—ãŸã€‚</p><blockquote><p>No savings plans coverage data was returned for this time period. Please adjust the time period or filters if this seems incorrect.ã€</p></blockquote><p><img src="https://i.imgur.com/ztLP9oV.png"></p><h2><span id="ã¾ã¨ã‚">ã¾ã¨ã‚</span></h2><p>Savings Plans ã‚«ãƒãƒ¬ãƒƒã‚¸å–å¾—æ™‚ã« DataUnavailableException ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹<br>= Savings Plans é©ç”¨å¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„<br>= Savings Plans ã‚’è²·ã†å¿…è¦ãŒãªã„</p><p>ã¨ã„ã†ã“ã¨ã§ã—ãŸã€‚</p><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;&lt;span id=&quot;toc&quot;&gt;ToC&lt;/span&gt;&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%8</summary>
      
    
    
    
    <category term="AWS" scheme="https://kenzo0107.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>Raspberry Pi 4 Model B ã« google-cloud-speech ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ãƒãƒã£ãŸã“ã¨</title>
    <link href="https://kenzo0107.github.io/2023/05/31/2023-06-01-install-google-cloud-speech-on-raspberrypi4b/"/>
    <id>https://kenzo0107.github.io/2023/05/31/2023-06-01-install-google-cloud-speech-on-raspberrypi4b/</id>
    <published>2023-05-31T15:00:00.000Z</published>
    <updated>2023-05-31T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="raspberry-pi-4-model-b-ã®ç’°å¢ƒ">Raspberry Pi 4 Model B ã®ç’°å¢ƒ</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/os-release</span></span><br><span class="line"></span><br><span class="line">PRETTY_NAME=&quot;Raspbian GNU/Linux 10 (buster)&quot;</span><br><span class="line">NAME=&quot;Raspbian GNU/Linux&quot;</span><br><span class="line">VERSION_ID=&quot;10&quot;</span><br><span class="line">VERSION=&quot;10 (buster)&quot;</span><br><span class="line">VERSION_CODENAME=buster</span><br><span class="line">ID=raspbian</span><br><span class="line">ID_LIKE=debian</span><br><span class="line">HOME_URL=&quot;http://www.raspbian.org/&quot;</span><br><span class="line">SUPPORT_URL=&quot;http://www.raspbian.org/RaspbianForums&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;http://www.raspbian.org/RaspbianBugs&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /proc/version</span></span><br><span class="line"></span><br><span class="line">Linux version 5.10.103-v8+ (dom@buildbot) (aarch64-linux-gnu-gcc-8 (Ubuntu/Linaro 8.4.0-3ubuntu1) 8.4.0, GNU ld (GNU Binutils for Ubuntu) 2.34) #1529 SMP PREEMPT Tue Mar 8 12:26:46 GMT 2022</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">uname</span> -a</span></span><br><span class="line"></span><br><span class="line">Linux pi4b-talk 5.10.103-v8+ #1529 SMP PREEMPT Tue Mar 8 12:26:46 GMT 2022 aarch64 GNU/Linux</span><br></pre></td></tr></table></figure><h2><span id="google-cloud-speech-ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">google-cloud-speech ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install -y libffi-dev libssl-dev</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip3 install grpcio google-cloud-speech</span></span><br></pre></td></tr></table></figure><h2><span id="ãƒ‡ãƒã‚¤ã‚¹ã«ç©ºãé ˜åŸŸãŒã‚ã‚Šã¾ã›ã‚“ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ">ã€Œãƒ‡ãƒã‚¤ã‚¹ã«ç©ºãé ˜åŸŸãŒã‚ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not install packages due to an EnvironmentError: [Errno 28] ãƒ‡ãƒã‚¤ã‚¹ã«ç©ºãé ˜åŸŸãŒã‚ã‚Šã¾ã›ã‚“</span><br></pre></td></tr></table></figure><p>ä¸€æ™‚çš„ã« tmp ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å†åº¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã§å›é¿ã§ãã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir $HOME/tmp</span><br><span class="line">$ export TMPDIR=$HOME/tmp</span><br></pre></td></tr></table></figure><p>ãã‚Œã§ã‚‚ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install grpcio google-cloud-speech</span><br><span class="line"></span><br><span class="line">Command &quot;python setup.py egg_info&quot; failed with error code 1 in /home/pi/tmp/pip-install-qocpvlue/grpcio/</span><br></pre></td></tr></table></figure><p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® pip ã§ãªã<br>python3 ã§ <a href="https://bootstrap.pypa.io/get-pip.py">https://bootstrap.pypa.io/get-pip.py</a> å®Ÿè¡Œã—<br>pip ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ç›´ã—ã€å†ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wget https://bootstrap.pypa.io/get-pip.py</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo python3 get-pip.py</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip --version</span></span><br><span class="line"></span><br><span class="line">pip 23.1.2 from /usr/local/lib/python3.7/dist-packages/pip (python 3.7)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip install --upgrade google-cloud-speech</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šã§æˆåŠŸã—ã¾ã—ãŸã€‚</p><p>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;raspberry-pi-4-model-b-ã®ç’°å¢ƒ&quot;&gt;Raspberry Pi 4 Model B ã®ç’°å¢ƒ&lt;/span&gt;&lt;/h2&gt;&lt;figure class=&quot;highlight console&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt</summary>
      
    
    
    
    <category term="RaspberryPI" scheme="https://kenzo0107.github.io/categories/RaspberryPI/"/>
    
    
  </entry>
  
  <entry>
    <title>Raspberry Pi ã« USB ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‚’æ¥ç¶šã—ãƒ†ã‚­ã‚¹ãƒˆã‚’éŸ³å£°å¤‰æ›ã—ãŠè©±ã—ã•ã›ã‚‹</title>
    <link href="https://kenzo0107.github.io/2023/05/17/2023-05-18-raspberrypi4b-speaks-via-usb-speaker/"/>
    <id>https://kenzo0107.github.io/2023/05/17/2023-05-18-raspberrypi4b-speaks-via-usb-speaker/</id>
    <published>2023-05-17T15:00:00.000Z</published>
    <updated>2023-05-17T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><div class="toc-content"><h3 class="menu-label"><span id="toc">ToC</span></h3><!-- toc --><ul><li><a href="#%E6%A6%82%E8%A6%81">æ¦‚è¦</a></li><li><a href="#%E7%92%B0%E5%A2%83">ç’°å¢ƒ</a></li><li><a href="#usb-%E3%82%B9%E3%83%94%E3%83%BC%E3%82%AB%E3%83%BC%E6%8E%A5%E7%B6%9A">usb ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼æ¥ç¶š</a><ul><li><a href="#%E6%8E%A5%E7%B6%9A%E5%85%88%E3%81%AE-usb-%E3%82%B9%E3%83%94%E3%83%BC%E3%82%AB%E3%83%BC%E3%81%AE%E3%82%AB%E3%83%BC%E3%83%89%E7%95%AA%E5%8F%B7%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E7%95%AA%E5%8F%B7%E3%82%92%E7%A2%BA%E8%AA%8D">æ¥ç¶šå…ˆã® USB ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã®ã‚«ãƒ¼ãƒ‰ç•ªå·ãƒ»ãƒ‡ãƒã‚¤ã‚¹ç•ªå·ã‚’ç¢ºèª</a></li><li><a href="#%E9%9F%B3%E3%81%8C%E3%82%B9%E3%83%94%E3%83%BC%E3%82%AB%E3%83%BC%E3%81%8B%E3%82%89%E8%81%9E%E3%81%93%E3%81%88%E3%82%8B%E3%81%8B%E3%83%86%E3%82%B9%E3%83%88">éŸ³ãŒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰èã“ãˆã‚‹ã‹ãƒ†ã‚¹ãƒˆ</a></li></ul></li><li><a href="#python-%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%81%8B%E3%82%89%E5%86%8D%E7%94%9F%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B">python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰å†ç”Ÿã—ã¦ã¿ã‚‹</a></li><li><a href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%8B%E3%82%89%E9%9F%B3%E5%A3%B0%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B">ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—èª­ã¿ä¸Šã’ã‚‹</a></li></ul><!-- tocstop --></div></div><hr><h2><span id="æ¦‚è¦">æ¦‚è¦</span></h2><p>Raspberry Pi ã¨ OpenAI ã‚’é€šã˜ã¦è‹±ä¼šè©±ã—ã‚ˆã†ï¼ã¨ã„ã†å‹•æ©Ÿã‹ã‚‰<br>æœ€åˆã®ä¸€æ­©ã¨ã—ã¦ USB ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰æŒ‡å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿ä¸Šã’ã‚‹æ§˜ã«ã—ã¦ã¿ã¾ã—ãŸã€‚</p><h2><span id="ç’°å¢ƒ">ç’°å¢ƒ</span></h2><p><a href="https://www.amazon.co.jp/gp/product/B09FHGX1QQ/?&_encoding=UTF8&tag=kenzo0107-22&linkCode=ur2&linkId=82485e7160979d4bd9f1971203c46c58&camp=247&creative=1211">Marstudy Raspberry Pi 4 Model B Starter ã‚­ãƒƒãƒˆ</a> ã§<br>ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸ Raspbian OS ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/os-release</span><br><span class="line"></span><br><span class="line">PRETTY_NAME=&quot;Raspbian GNU/Linux 10 (buster)&quot;</span><br><span class="line">NAME=&quot;Raspbian GNU/Linux&quot;</span><br><span class="line">VERSION_ID=&quot;10&quot;</span><br><span class="line">VERSION=&quot;10 (buster)&quot;</span><br><span class="line">VERSION_CODENAME=buster</span><br><span class="line">ID=raspbian</span><br><span class="line">ID_LIKE=debian</span><br><span class="line">HOME_URL=&quot;http://www.raspbian.org/&quot;</span><br><span class="line">SUPPORT_URL=&quot;http://www.raspbian.org/RaspbianForums&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;http://www.raspbian.org/RaspbianBugs&quot;</span><br></pre></td></tr></table></figure><h2><span id="usb-ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼æ¥ç¶š">usb ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼æ¥ç¶š</span></h2><p><a href="https://www.amazon.co.jp/gp/product/B071699KYN/?&_encoding=UTF8&tag=kenzo0107-22&linkCode=ur2&linkId=79fbe724887de803e45a5601f5548940&camp=247&creative=1211">ã‚µãƒ³ãƒ¯ã‚µãƒ—ãƒ©ã‚¤ ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ PC ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ MS-P08UBK</a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p><p>è‡ªåˆ†ãŒè³¼å…¥ã—ãŸ 2023-05-10 ã¯ Â¥857 ã§ã—ãŸã€‚</p><h3><span id="æ¥ç¶šå…ˆã®-usb-ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã®ã‚«ãƒ¼ãƒ‰ç•ªå·ãƒ‡ãƒã‚¤ã‚¹ç•ªå·ã‚’ç¢ºèª">æ¥ç¶šå…ˆã® USB ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã®ã‚«ãƒ¼ãƒ‰ç•ªå·ãƒ»ãƒ‡ãƒã‚¤ã‚¹ç•ªå·ã‚’ç¢ºèª</span></h3><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">aplay -l</span></span><br><span class="line">**** ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ãƒã‚¤ã‚¹ PLAYBACK ã®ãƒªã‚¹ãƒˆ ****</span><br><span class="line">ã‚«ãƒ¼ãƒ‰ 1: Headphones [bcm2835 Headphones], ãƒ‡ãƒã‚¤ã‚¹ 0: bcm2835 Headphones [bcm2835 Headphones]</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹: 8/8</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #0: subdevice #0</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #1: subdevice #1</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #2: subdevice #2</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #3: subdevice #3</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #4: subdevice #4</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #5: subdevice #5</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #6: subdevice #6</span><br><span class="line">  ã‚µãƒ–ãƒ‡ãƒã‚¤ã‚¹ #7: subdevice #7</span><br></pre></td></tr></table></figure><ul><li>ã‚«ãƒ¼ãƒ‰ç•ªå· = 1</li><li>ãƒ‡ãƒã‚¤ã‚¹ç•ªå· = 0</li></ul><h3><span id="éŸ³ãŒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰èã“ãˆã‚‹ã‹ãƒ†ã‚¹ãƒˆ">éŸ³ãŒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰èã“ãˆã‚‹ã‹ãƒ†ã‚¹ãƒˆ</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// plughw:&lt;ã‚«ãƒ¼ãƒ‰&gt;,&lt;ãƒ‡ãƒã‚¤ã‚¹&gt;</span><br><span class="line">$ speaker-test -D plughw:1,0 -t wav</span><br><span class="line"></span><br><span class="line">// Ctrl+c ã§ä¸­æ–­ã—çµ‚äº†ã—ã¾ã™</span><br></pre></td></tr></table></figure><h2><span id="python-ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰å†ç”Ÿã—ã¦ã¿ã‚‹">python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰å†ç”Ÿã—ã¦ã¿ã‚‹</span></h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip3 install pygame</span></span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl https://www.soundjay.com/buttons/button-3.mp3 -o button.mp3</span></span><br></pre></td></tr></table></figure><ul><li>play_sound.py</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_sound_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    pygame.mixer.init()</span><br><span class="line">    pygame.mixer.music.load(file_path)</span><br><span class="line">    pygame.mixer.music.play()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> pygame.mixer.music.get_busy() == <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    play_sound_file(<span class="string">&#x27;button.mp3&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹å®Ÿè¡Œã— mp3 ãŒå†ç”Ÿã•ã‚Œã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">python3 play_sound.py</span></span><br></pre></td></tr></table></figure><h2><span id="ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—èª­ã¿ä¸Šã’ã‚‹">ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—èª­ã¿ä¸Šã’ã‚‹</span></h2><ul><li>speech.py</li></ul><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip3 install gTTS</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip3 install pydub</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gtts <span class="keyword">import</span> gTTS</span><br><span class="line"><span class="keyword">from</span> pydub <span class="keyword">import</span> AudioSegment</span><br><span class="line"><span class="keyword">from</span> pydub.playback <span class="keyword">import</span> play</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">speechja</span>(<span class="params">stext</span>):</span><br><span class="line">    tts = gTTS(stext, lang=<span class="string">&quot;ja&quot;</span>)</span><br><span class="line">    tts.save(<span class="string">&quot;/tmp/out.mp3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sound = AudioSegment.from_mp3(<span class="string">&quot;/tmp/out.mp3&quot;</span>)</span><br><span class="line">    play(sound)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    msg = <span class="string">&quot;ã¯ã„ã€ãŠå…ƒæ°—ã§ã™ã‹ï¼Ÿ&quot;</span></span><br><span class="line">    speechja(msg)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹å®Ÿè¡Œã—ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰ã€Œã¯ã„ã€ãŠå…ƒæ°—ã§ã™ã‹ï¼Ÿã€ã¨å†ç”Ÿã•ã‚Œã¾ã™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python3 speech.py</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š<br>å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p><p>æ¬¡å›ã¯ãƒã‚¤ã‚¯ã‹ã‚‰éŸ³å£°èªè­˜ã•ã›ã‚‹è¨­å®šã‚’åŸ·ç­†ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;toc&quot;&gt;
&lt;div class=&quot;toc-content&quot;&gt;
&lt;h3 class=&quot;menu-label&quot;&gt;&lt;span id=&quot;toc&quot;&gt;ToC&lt;/span&gt;&lt;/h3&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E6%A6%8</summary>
      
    
    
    
    <category term="RaspberryPI" scheme="https://kenzo0107.github.io/categories/RaspberryPI/"/>
    
    
  </entry>
  
</feed>
