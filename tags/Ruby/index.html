<div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">タグ</a></li><li class="is-active"><a href="#" aria-current="page">Ruby</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-12-05T15:00:00.000Z" title="2019-12-05T15:00:00.000Z">2019-12-06</time><span class="level-item">2分 read (About 335 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/12/05/2019-12-06-fix-can-t-find-gem-bundler-0-a-with-executable-bundle-gem-gemnotfoundexception/">Fix: can&#039;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)</a></h1><div class="content"><p>rbenv で複数 ruby バージョンが存在する環境下で <code>bundle install</code> しようとすると以下のエラーが出てしまいました。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can<span class="string">'t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ruby バージョンは合ってる、</li>
<li>Gemfile もある、</li>
<li><code>gem install bundler</code> して bundle もある ← ここがダメだった</li>
</ul>
<p>けど、エラー</p>
<p>ちょいちょいハマってたので備忘録とりました。</p></div><a class="article-more button is-small size-small" href="/2019/12/05/2019-12-06-fix-can-t-find-gem-bundler-0-a-with-executable-bundle-gem-gemnotfoundexception/#more">Read More</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-25T15:00:00.000Z" title="2019-11-25T15:00:00.000Z">2019-11-26</time><span class="level-item">5分 read (About 700 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/11/25/2019-11-26-ruby-inject-enumerable/">Ruby inject (Enumerable) メソッドを学ぶ</a></h1><div class="content"><div style="text-align:center;">
<img src="https://cdn-ak.f.st-hatena.com/images/fotolife/k/kenzo0107/20191123/20191123143247.png" width="100%">
</div>

<h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>お題を通して Ruby で inject メソッドを学びました。その備忘録です。</p></div><a class="article-more button is-small size-small" href="/2019/11/25/2019-11-26-ruby-inject-enumerable/#more">Read More</a></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/03/12/2019-03-13-rails-gem-sendgrid-ruby-x-sendgrid-event-notification-api-key/"><img class="thumbnail" src="https://cdn-ak.f.st-hatena.com/images/fotolife/k/kenzo0107/20190313/20190313234822.png" alt="Rails (gem &#039;sendgrid-ruby&#039;) × SendGrid の Event Notification で API Key ごとの独自メタ情報を設定する"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-03-12T15:00:00.000Z" title="2019-03-12T15:00:00.000Z">2019-03-13</time><span class="level-item">6分 read (About 832 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/03/12/2019-03-13-rails-gem-sendgrid-ruby-x-sendgrid-event-notification-api-key/">Rails (gem &#039;sendgrid-ruby&#039;) × SendGrid の Event Notification で API Key ごとの独自メタ情報を設定する</a></h1><div class="content"><h2 id="SendGrid-の-Event-Notification-の使い所"><a href="#SendGrid-の-Event-Notification-の使い所" class="headerlink" title="SendGrid の Event Notification の使い所"></a>SendGrid の Event Notification の使い所</h2><p>SendGrid には Event Notification という Webhook を設定することでメールの送信状態をイベント情報として取得することができます。</p>
<p>メールを SendGrid が受信した、送信先に届いた、等の情報です。</p>
<p><a href="https://sendgrid.kke.co.jp/docs/Tutorials/C_Manage_Events/using_activity.html">SendGrid - メールが届いているか確認する</a></p>
<p>例えば、未達だったメールの情報を取得したい場合等に、この Webhook を利用し、イベント情報を保存することで調査や集計が可能です。</p>
<p>AWS API Gateway + Lambda で構築したエンドポイントに投げ、S3 に保存し、送信失敗件数を Athena で検索集計する、ということができます。</p>
<h2 id="何か問題でも？"><a href="#何か問題でも？" class="headerlink" title="何か問題でも？"></a>何か問題でも？</h2></div><a class="article-more button is-small size-small" href="/2019/03/12/2019-03-13-rails-gem-sendgrid-ruby-x-sendgrid-event-notification-api-key/#more">Read More</a></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/02/16/2019-02-17-rails-recaptcha-v3-bot/"><img class="thumbnail" src="https://cdn-ak.f.st-hatena.com/images/fotolife/k/kenzo0107/20190216/20190216210737.png" alt="Rails に reCAPTCHA v3 導入して bot 対策"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-02-16T15:00:00.000Z" title="2019-02-16T15:00:00.000Z">2019-02-17</time><span class="level-item">12分 read (About 1769 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/02/16/2019-02-17-rails-recaptcha-v3-bot/">Rails に reCAPTCHA v3 導入して bot 対策</a></h1><div class="content"><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>Rails で構築した Webサービスで bot 攻撃を定期的に受けた為、問い合わせフォームに reCAPTCHA v3 を導入しました。</p>
<h2 id="何故-v2-でなく、reCAPTCHA-v3"><a href="#何故-v2-でなく、reCAPTCHA-v3" class="headerlink" title="何故 v2 でなく、reCAPTCHA v3 ?"></a>何故 v2 でなく、reCAPTCHA v3 ?</h2></div><a class="article-more button is-small size-small" href="/2019/02/16/2019-02-17-rails-recaptcha-v3-bot/#more">Read More</a></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2018/06/05/2018-06-06-rails-redis-threadsafe/"><img class="thumbnail" src="https://cdn-ak.f.st-hatena.com/images/fotolife/k/kenzo0107/20180606/20180606115540.jpg" alt="Rails × Redis でスレッドセーフなアクセス数ランキング実装"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-06-05T15:00:00.000Z" title="2018-06-05T15:00:00.000Z">2018-06-06</time><span class="level-item">7分 read (About 1055 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/06/05/2018-06-06-rails-redis-threadsafe/">Rails × Redis でスレッドセーフなアクセス数ランキング実装</a></h1><div class="content"><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>メディアサイトで記事ページへアクセス数ランキングを実装しました。</p>
<ul>
<li>Rails 5.1</li>
<li>Redis (AWS ElastiCache 3.2.10)</li>
</ul>
<p>その際にマルチスレッド環境を考慮してスレッドセーフな実装を心がけました。</p></div><a class="article-more button is-small size-small" href="/2018/06/05/2018-06-06-rails-redis-threadsafe/#more">Read More</a></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2018/03/06/2018-03-07-change-ruby-version-via-rbenv/"><img class="thumbnail" src="https://cdn-ak.f.st-hatena.com/images/fotolife/k/kenzo0107/20180307/20180307225204.png" alt="Linux に rbenv をセットアップして ruby バージョンを切り替える"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-03-06T15:00:00.000Z" title="2018-03-06T15:00:00.000Z">2018-03-07</time><span class="level-item">1分 read (About 190 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/03/06/2018-03-07-change-ruby-version-via-rbenv/">Linux に rbenv をセットアップして ruby バージョンを切り替える</a></h1><div class="content"><h2><span id="概要">概要</span></h2><p>サーバの ruby のバージョンが古かった為、<br>rbenv で ruby のバージョンを切り替える様にした際の設定メモです。</p>
<h2><span id="setup-rbenv">setup rbenv</span></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/sstephenson/rbenv.git ~/.rbenv</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'export PATH="$HOME/.rbenv/bin:$PATH"'</span> &gt;&gt; ~/.bash_profile</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'eval "$(rbenv init -)"'</span> &gt;&gt; ~/.bash_profile</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ~/.bash_profile</span><br><span class="line">$ rbenv --version</span><br><span class="line">rbenv 1.1.1-30-gc8ba27f</span><br></pre></td></tr></table></figure>

<h2><span id="rbenv-経由で-ruby-250-インストール">rbenv 経由で Ruby 2.5.0 インストール</span></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ rbenv install 2.5.0</span><br><span class="line"></span><br><span class="line">// 現 version は system. まだ 2.5.0 に切り替わっていない</span><br><span class="line">$ rbenv versions</span><br><span class="line">* system (<span class="built_in">set</span> by /home/vagrant/.rbenv/version)</span><br><span class="line">  2.5.0</span><br><span class="line"></span><br><span class="line">// 2.5.0 へ切り替え</span><br><span class="line">$ rbenv global 2.5.0</span><br><span class="line"></span><br><span class="line">// 切り替え確認</span><br><span class="line">$ rbenv versions</span><br><span class="line">  system</span><br><span class="line">* 2.5.0 (<span class="built_in">set</span> by /home/vagrant/.rbenv/version)</span><br><span class="line"></span><br><span class="line">$ ruby -v</span><br><span class="line">ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-linux]</span><br><span class="line"></span><br><span class="line">// リフレッシュしないと .rbenv/versions/2.5.0/bin 以下のパスを通らない</span><br><span class="line">$ rbenv <span class="built_in">rehash</span></span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2016-05-25T15:00:00.000Z" title="2016-05-25T15:00:00.000Z">2016-05-26</time><span class="level-item">1分 read (About 152 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/05/25/2016-05-26-ruby-30-sec-cooking-get-access-ip-from-japan/">日本国内からアクセスされるIP取得スクリプト Ruby 30秒クッキング</a></h1><div class="content"><h2><span id="まずスクリプト">まずスクリプト</span></h2><script src="//gist.github.com/kenzo0107/714ece62cf6450386ff0fb16fd5b777a.js"></script>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://gist.github.com/kenzo0107/714ece62cf6450386ff0fb16fd5b777a</span><br><span class="line">$ <span class="built_in">cd</span> 714ece62cf6450386ff0fb16fd5b777a</span><br><span class="line">$ ruby getJapanIP.rb</span><br><span class="line"></span><br><span class="line">1.0.16.0</span><br><span class="line">1.0.64.0</span><br><span class="line">1.1.64.0</span><br><span class="line">1.5.0.0</span><br><span class="line">...</span><br><span class="line">中略</span><br><span class="line">...</span><br><span class="line">223.223.164.0</span><br><span class="line">223.223.208.0</span><br><span class="line">223.223.224.0</span><br></pre></td></tr></table></figure>

<h2><span id="概要">概要</span></h2><p>作った経緯は<br>日本版・海外版URLがあり、<br>海外版に日本からアクセスした場合は<br>日本版サイトにリダイレクトさせたい、<br>という依頼があった為です。</p>
<p>このスクリプトを利用して<br>海外版サイト .htaccess等でリダイレクト設定をしました。</p>
<p>以上です。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2015-10-21T15:00:00.000Z" title="2015-10-21T15:00:00.000Z">2015-10-22</time><span class="level-item">数秒 read (About 73 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2015/10/21/2015-10-22-install-ruby-gem/">Ruby &amp; gem インストール</a></h1><div class="content"><p>備忘録です。</p>
<h2><span id="環境">環境</span></h2><ul>
<li>CentOS 5.8 (Final)</li>
</ul>
<h2><span id="ruby-212-インストール">ruby 2.1.2 インストール</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># cd &#x2F;usr&#x2F;local&#x2F;src</span><br><span class="line"># wget http:&#x2F;&#x2F;cache.ruby-lang.org&#x2F;pub&#x2F;ruby&#x2F;2.1&#x2F;ruby-2.1.2.tar.gz</span><br><span class="line"># tar xvfz ruby-2.1.2.tar.gz</span><br><span class="line"># rm ruby-2.1.2.tar.gz</span><br><span class="line"># cd ruby-2.1.2</span><br><span class="line"># .&#x2F;configure</span><br><span class="line"># make; make install</span><br></pre></td></tr></table></figure>

<h2><span id="gem-インストール">gem インストール</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># wget http:&#x2F;&#x2F;production.cf.rubygems.org&#x2F;rubygems&#x2F;rubygems-2.2.2.zip</span><br><span class="line"># unzip rubygems-2.2.2.zip</span><br><span class="line"># cd rubygems-2.2.2</span><br><span class="line"># ruby setup.rb</span><br></pre></td></tr></table></figure>

<p>以上</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2015-08-05T15:00:00.000Z" title="2015-08-05T15:00:00.000Z">2015-08-06</time><span class="level-item">1分 read (About 156 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2015/08/05/2015-08-06-install-ruby-on-centos7/">Ruby インストール on CentOS7</a></h1><div class="content"><h2><span id="環境">環境</span></h2><ul>
<li>AWS</li>
<li>CentOS Linux release 7.0.1406 (Core)</li>
</ul>
<h2><span id="必要モジュールインストール">必要モジュールインストール</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum -y install git libffi libffi-dev gcc openssl-devel readline-devel zlib-devel</span><br></pre></td></tr></table></figure>

<h2><span id="rbenv-ruby-build-ダウンロード">rbenv, ruby-build ダウンロード</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https:&#x2F;&#x2F;github.com&#x2F;sstephenson&#x2F;rbenv.git ~&#x2F;.rbenv</span><br><span class="line">$ git clone https:&#x2F;&#x2F;github.com&#x2F;sstephenson&#x2F;ruby-build.git ~&#x2F;.rbenv&#x2F;plugins&#x2F;ruby-build</span><br></pre></td></tr></table></figure>

<h2><span id="rbenv-path指定">rbenv PATH指定</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ echo &#39;export PATH&#x3D;&quot;$HOME&#x2F;.rbenv&#x2F;bin:$PATH&quot;&#39; &gt;&gt; ~&#x2F;.bash_profile</span><br><span class="line">$ echo &#39;eval &quot;$(rbenv init -)&quot;&#39; &gt;&gt; ~&#x2F;.bash_profile</span><br><span class="line">$ exec $SHELL</span><br><span class="line">$ source ~&#x2F;.bash_profile</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ rbenv install -list</span><br><span class="line"></span><br><span class="line">Available versions:</span><br><span class="line">   :</span><br><span class="line">   :</span><br><span class="line">  2.0.0-p643</span><br><span class="line">  2.0.0-p645 ← 2.0.0の最新 (※2015&#x2F;08&#x2F;06時点)</span><br><span class="line">  2.1.0-dev</span><br><span class="line">  2.1.0-preview1</span><br><span class="line">  2.1.0-preview2</span><br><span class="line">  2.1.0-rc1</span><br><span class="line">   :</span><br></pre></td></tr></table></figure>

<h2><span id="ruby-インストール">ruby インストール</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rbenv install -v 2.0.0-p645</span><br></pre></td></tr></table></figure>

<h2><span id="再読込">再読込</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rbenv rehash</span><br></pre></td></tr></table></figure>

<h2><span id="インストールしたバージョンに切り替え">インストールしたバージョンに切り替え</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rbenv global 2.0.0-p645</span><br></pre></td></tr></table></figure>

<h2><span id="確認">確認</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ruby -v</span><br><span class="line">ruby 2.0.0p645 (2015-04-13 revision 50299) [x86_64-linux]</span><br></pre></td></tr></table></figure>

<p>以上</p>
</div></article></div>